import{A as e,D as t,E as s,F as a,J as l,L as r,M as i,N as n,Q as d,St as c,U as o,_ as m,et as x,f as h,g as u,j as p,jt as g,o as j,x as f,y as b,z as v}from"./react-vendor-2hQaKJT0.js";import"./supabase-vendor-CLitCmdP.js";import{a as N,i as y,n as w,r as k,t as T}from"./index-4_19cBdp.js";import"./NotificationBell-DOonUTZz.js";import{t as _}from"./Layout-Dciw3jEd.js";import{t as D}from"./Card-9uYyr2OA.js";var S=x();const $=({title:e,value:t,icon:s,trend:a,color:l="blue"})=>{const r="bg-emerald-500/10 text-emerald-400",i="bg-red-500/10 text-red-400";return(0,S.jsx)("div",{className:"stat-card p-6 hover:scale-[1.02] transition-all duration-300 hover:shadow-2xl hover:shadow-blue-500/10",children:(0,S.jsxs)("div",{className:"flex items-start justify-between",children:[(0,S.jsxs)("div",{className:"flex-1",children:[(0,S.jsx)("p",{className:"text-sm font-medium text-slate-400 mb-1",children:e}),(0,S.jsx)("p",{className:"text-3xl font-bold text-white tracking-tight",children:t}),a&&(0,S.jsxs)("div",{className:"flex items-center mt-3",children:[(0,S.jsxs)("span",{className:k("inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",a.isPositive?r:i),children:[a.isPositive?"â†‘":"â†“"," ",Math.abs(a.value),"%"]}),(0,S.jsx)("span",{className:"text-xs text-slate-500 ml-2",children:"son aydan"})]})]}),s&&(0,S.jsx)("div",{className:k("flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-xl bg-gradient-to-br shadow-lg",{blue:"from-blue-500 to-blue-600",green:"from-emerald-500 to-emerald-600",yellow:"from-amber-500 to-orange-500",red:"from-red-500 to-pink-500",purple:"from-purple-500 to-violet-600",cyan:"from-cyan-500 to-blue-500"}[l],{blue:"shadow-blue-500/20",green:"shadow-emerald-500/20",yellow:"shadow-amber-500/20",red:"shadow-red-500/20",purple:"shadow-purple-500/20",cyan:"shadow-cyan-500/20"}[l]),children:(0,S.jsx)("div",{className:"text-white w-6 h-6 [&>svg]:w-6 [&>svg]:h-6 [&>svg]:block",children:s})})]})})},C=({stats:t})=>{const l=t.totalTasks>0?Math.round(t.completedTasks/t.totalTasks*100):0;return(0,S.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,S.jsx)($,{title:"Toplam GÃ¶revler",value:t.totalTasks,icon:(0,S.jsx)(p,{className:"h-6 w-6"}),color:"blue"}),(0,S.jsx)($,{title:"Tamamlanan GÃ¶revler",value:t.completedTasks,icon:(0,S.jsx)(a,{className:"h-6 w-6"}),color:"green",trend:{value:l,isPositive:l>=50}}),(0,S.jsx)($,{title:"Bekleyen Sorunlar",value:t.pendingIssues,icon:(0,S.jsx)(s,{className:"h-6 w-6"}),color:"yellow"}),(0,S.jsx)($,{title:"Geciken GÃ¶revler",value:t.overdueTasks,icon:(0,S.jsx)(e,{className:"h-6 w-6"}),color:"red"})]})},z=({activities:e,maxItems:t=10})=>{const s=e.slice(0,t),a=e=>{const t="h-9 w-9 rounded-xl flex items-center justify-center text-white text-sm font-semibold shadow-lg";switch(e){case"task_created":return(0,S.jsx)("div",{className:k(t,"bg-gradient-to-br from-blue-500 to-blue-600 shadow-blue-500/30"),children:"+"});case"task_completed":return(0,S.jsx)("div",{className:k(t,"bg-gradient-to-br from-emerald-500 to-emerald-600 shadow-emerald-500/30"),children:"âœ“"});case"issue_reported":return(0,S.jsx)("div",{className:k(t,"bg-gradient-to-br from-amber-500 to-orange-500 shadow-amber-500/30"),children:"!"});case"issue_assigned":return(0,S.jsx)("div",{className:k(t,"bg-gradient-to-br from-purple-500 to-violet-600 shadow-purple-500/30"),children:"â†’"});default:return(0,S.jsx)("div",{className:k(t,"bg-gradient-to-br from-slate-500 to-slate-600"),children:"â€¢"})}},l=e=>{const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/6e4);if(a<1)return"Az Ã¶nce";if(a<60)return`${a} dakika Ã¶nce`;const l=Math.floor(a/60);if(l<24)return`${l} saat Ã¶nce`;const r=Math.floor(l/24);return r<7?`${r} gÃ¼n Ã¶nce`:t.toLocaleDateString("tr-TR")};return(0,S.jsxs)(D,{title:"Son Aktiviteler",padding:"none",children:[(0,S.jsx)("div",{className:"divide-y divide-white/5",children:0===s.length?(0,S.jsx)("div",{className:"p-6 text-center text-slate-500",children:"HenÃ¼z aktivite bulunmuyor"}):s.map((e,t)=>(0,S.jsx)("div",{className:"p-4 hover:bg-white/[0.02] transition-colors animate-fadeIn",style:{animationDelay:.1*t+"s"},children:(0,S.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,S.jsx)("div",{className:"flex-shrink-0",children:a(e.type)}),(0,S.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,S.jsx)("p",{className:"text-sm font-medium text-white",children:e.title}),(0,S.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:e.description}),(0,S.jsxs)("div",{className:"flex items-center mt-2 space-x-2",children:[e.user&&(0,S.jsx)("span",{className:"text-xs text-slate-400",children:e.user.name}),(0,S.jsxs)("span",{className:"text-xs text-slate-500",children:["â€¢ ",l(e.timestamp)]})]})]})]})},e.id))}),e.length>t&&(0,S.jsx)("div",{className:"p-4 border-t border-white/5 text-center",children:(0,S.jsxs)("button",{className:"text-sm font-medium text-blue-400 hover:text-blue-300 transition-colors",children:["TÃ¼mÃ¼nÃ¼ GÃ¶rÃ¼ntÃ¼le (",e.length-t," daha)"]})})]})};var A=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/tag-distribution",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch tag distribution");return(await t.json()).data},E=["#8b5cf6","#ec4899","#3b82f6","#10b981","#f59e0b","#ef4444","#06b6d4","#84cc16","#f97316","#6366f1"];const G=()=>{const{data:e,isLoading:t,error:s}=d({queryKey:["tag-distribution"],queryFn:A,refetchInterval:6e4});if(t)return(0,S.jsx)(D,{title:"Etiketlere GÃ¶re Ä°ÅŸ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,S.jsx)(T,{size:"md"})})});if(s)return(0,S.jsx)(D,{title:"Etiketlere GÃ¶re Ä°ÅŸ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!e||0===e.length)return(0,S.jsx)(D,{title:"Etiketlere GÃ¶re Ä°ÅŸ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z etiketli gÃ¶rev bulunmuyor."})});const a=e.reduce((e,t)=>e+t.total,0),l=e.slice(0,8);let r=0;const i=l.map((e,t)=>{const s=e.total/a*100,l=r;return r+=s/100*360,{...e,color:E[t%E.length],percentage:s,startAngle:l,endAngle:r}}),n=(e,t,s=80)=>{const a=(e-90)*(Math.PI/180),l=(t-90)*(Math.PI/180);return`M 100 100 L ${100+s*Math.cos(a)} ${100+s*Math.sin(a)} A ${s} ${s} 0 ${t-e>180?1:0} 1 ${100+s*Math.cos(l)} ${100+s*Math.sin(l)} Z`};return(0,S.jsxs)(D,{title:"Etiketlere GÃ¶re Ä°ÅŸ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:[(0,S.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-6",children:[(0,S.jsx)("div",{className:"relative w-52 h-52 shrink-0",children:(0,S.jsxs)("svg",{viewBox:"0 0 200 200",className:"w-full h-full transform -rotate-0",children:[i.map(e=>(0,S.jsx)("path",{d:n(e.startAngle,e.endAngle),fill:e.color,className:"hover:opacity-80 transition-opacity cursor-pointer",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:(0,S.jsxs)("title",{children:[e.tag,": ",e.total," gÃ¶rev (%",Math.round(e.percentage),")"]})},e.tag)),(0,S.jsx)("circle",{cx:"100",cy:"100",r:"45",fill:"#1e293b"}),(0,S.jsx)("text",{x:"100",y:"95",textAnchor:"middle",className:"fill-white text-xl font-bold",children:a}),(0,S.jsx)("text",{x:"100",y:"115",textAnchor:"middle",className:"fill-slate-400 text-xs",children:"Toplam"})]})}),(0,S.jsx)("div",{className:"flex-1 grid grid-cols-2 gap-2 w-full",children:i.map(e=>(0,S.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-slate-800/50 transition-colors",children:[(0,S.jsx)("div",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:e.color}}),(0,S.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,S.jsx)("p",{className:"text-sm text-white truncate",children:e.tag}),(0,S.jsxs)("p",{className:"text-xs text-slate-400",children:[e.total," gÃ¶rev â€¢ %",Math.round(e.percentage)]})]})]},e.tag))})]}),(0,S.jsx)("div",{className:"mt-4 pt-4 border-t border-white/10",children:(0,S.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-lg font-bold text-emerald-400",children:e.reduce((e,t)=>e+t.completed,0)}),(0,S.jsx)("p",{className:"text-xs text-slate-400",children:"Tamamlanan"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-lg font-bold text-blue-400",children:e.reduce((e,t)=>e+t.active,0)}),(0,S.jsx)("p",{className:"text-xs text-slate-400",children:"Aktif"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-lg font-bold text-purple-400",children:e.length}),(0,S.jsx)("p",{className:"text-xs text-slate-400",children:"Etiket"})]})]})})]})};var B=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/user-workload",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch user workload");return(await t.json()).data};const Y=()=>{const{isAdmin:e}=y(),{data:t,isLoading:s,error:a}=d({queryKey:["user-workload"],queryFn:B,enabled:e,refetchInterval:6e4});if(!e)return null;if(s)return(0,S.jsx)(D,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,S.jsx)(T,{size:"md"})})});if(a)return(0,S.jsx)(D,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!t||0===t.length)return(0,S.jsx)(D,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z kullanÄ±cÄ± verisi bulunmuyor."})});const l=[...t].sort((e,t)=>t.totalTasks-e.totalTasks),r=Math.max(...l.map(e=>e.totalTasks),1);return(0,S.jsx)(D,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,S.jsxs)("div",{className:"space-y-1",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,S.jsx)("span",{className:"font-medium text-white truncate max-w-[200px]",children:e.userName}),(0,S.jsxs)("span",{className:"text-slate-400",children:[e.totalTasks," gÃ¶rev"]})]}),(0,S.jsxs)("div",{className:"relative h-8 bg-slate-700/50 rounded-lg overflow-hidden",children:[(0,S.jsx)("div",{className:"absolute left-0 top-0 h-full bg-emerald-500/80 transition-all",style:{width:e.completedTasks/r*100+"%"}}),(0,S.jsx)("div",{className:"absolute top-0 h-full bg-blue-500/80 transition-all",style:{left:e.completedTasks/r*100+"%",width:e.inProgressTasks/r*100+"%"}}),(0,S.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,S.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow",children:[e.completionRate,"% tamamlandÄ±"]})})]})]},e.userId))}),(0,S.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-sm pt-4 border-t border-white/10",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("div",{className:"w-4 h-4 bg-emerald-500 rounded mr-2"}),(0,S.jsx)("span",{className:"text-slate-300",children:"Tamamlanan"})]}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),(0,S.jsx)("span",{className:"text-slate-300",children:"Devam Eden"})]}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("div",{className:"w-4 h-4 bg-slate-700/50 rounded mr-2"}),(0,S.jsx)("span",{className:"text-slate-300",children:"DiÄŸer"})]})]}),(0,S.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-white/10",children:[(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("p",{className:"text-2xl font-bold text-white",children:l.length}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"KullanÄ±cÄ±"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:l.reduce((e,t)=>e+t.totalTasks,0)}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam GÃ¶rev"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsxs)("p",{className:"text-2xl font-bold text-emerald-400",children:[Math.round(l.reduce((e,t)=>e+t.completionRate,0)/l.length),"%"]}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Ort. Tamamlama"})]})]})]})})};var I=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/dashboard",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch dashboard metrics");return(await t.json()).data};const M=()=>{const{data:e,isLoading:t,error:s}=d({queryKey:["dashboard-metrics"],queryFn:I,refetchInterval:6e4});if(t)return(0,S.jsx)(D,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,S.jsx)(T,{size:"md"})})});if(s)return(0,S.jsx)(D,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!e||0===e.issues.total)return(0,S.jsx)(D,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z sorun bulunmuyor."})});const a=[{name:"Kritik",value:e.issues.byPriority.critical,color:"bg-red-500",textColor:"text-red-400"},{name:"YÃ¼ksek",value:e.issues.byPriority.high,color:"bg-orange-500",textColor:"text-orange-400"},{name:"Orta",value:e.issues.byPriority.medium,color:"bg-amber-500",textColor:"text-amber-400"},{name:"DÃ¼ÅŸÃ¼k",value:e.issues.byPriority.low,color:"bg-emerald-500",textColor:"text-emerald-400"}],l=e.issues.total;return(0,S.jsx)(D,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsx)("div",{className:"flex items-center justify-center",children:(0,S.jsxs)("div",{className:"relative w-48 h-48",children:[(0,S.jsx)("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:a.reduce((e,t)=>{const s=l>0?t.value/l*100:0,a=2*Math.PI*40,r=e.offset,i=`${s/100*a} ${a}`;return e.elements.push((0,S.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:t.color.replace("bg-",""),strokeWidth:"20",strokeDasharray:i,strokeDashoffset:-r,className:t.color},t.name)),e.offset+=s/100*a,e},{elements:[],offset:0}).elements}),(0,S.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,S.jsx)("p",{className:"text-3xl font-bold text-white",children:l}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam"})]})]})}),(0,S.jsx)("div",{className:"space-y-2",children:a.map(e=>{const t=l>0?Math.round(e.value/l*100):0;return(0,S.jsxs)("div",{className:"flex items-center justify-between",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,S.jsx)("div",{className:`w-4 h-4 rounded ${e.color}`}),(0,S.jsx)("span",{className:"text-sm font-medium text-slate-300",children:e.name})]}),(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsxs)("span",{className:"text-sm text-slate-400",children:[e.value," sorun"]}),(0,S.jsxs)("span",{className:`text-sm font-semibold ${e.textColor}`,children:[t,"%"]})]})]},e.name)})}),(0,S.jsx)("div",{className:"pt-4 border-t border-white/10",children:(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("p",{className:"text-2xl font-bold text-amber-400",children:e.issues.pending}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Bekleyen"})]}),(0,S.jsxs)("div",{className:"text-center",children:[(0,S.jsx)("p",{className:"text-2xl font-bold text-red-400",children:e.issues.byPriority.critical+e.issues.byPriority.high}),(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Acil"})]})]})})]})})};var O=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/employees-summary",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch employees summary");return(await t.json()).data},P=({score:e})=>{return(0,S.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(t=e,t>=90?"bg-green-100 text-green-800":t>=70?"bg-yellow-100 text-yellow-800":t>=50?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"),children:[e," puan"]});var t};const F=()=>{const{data:e,isLoading:t,error:s}=d({queryKey:["employees-summary"],queryFn:O,refetchInterval:6e4});if(t)return(0,S.jsx)(D,{title:"Ã‡alÄ±ÅŸan Ã–zeti",padding:"md",children:(0,S.jsx)("div",{className:"flex justify-center py-8",children:(0,S.jsx)(T,{size:"md"})})});if(s)return(0,S.jsx)(D,{title:"Ã‡alÄ±ÅŸan Ã–zeti",padding:"md",children:(0,S.jsx)("p",{className:"text-red-600 text-sm",children:"Ã‡alÄ±ÅŸan verileri yÃ¼klenemedi."})});const a=[...e||[]].sort((e,t)=>t.activeTasks-e.activeTasks);return(0,S.jsx)(D,{title:"Ã‡alÄ±ÅŸan Ã–zeti",subtitle:`${e?.length||0} Ã§alÄ±ÅŸan`,padding:"md",children:(0,S.jsxs)("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[a.map(e=>(0,S.jsxs)("div",{className:"p-3 rounded-lg border "+(e.overdueTasks>0?"border-red-200 bg-red-50":"border-gray-200 bg-white"),children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,S.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium",children:e.full_name.charAt(0).toUpperCase()}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"font-medium text-gray-900",children:e.full_name}),(0,S.jsx)("p",{className:"text-xs text-gray-500",children:e.job_description||e.email})]})]}),(0,S.jsx)(P,{score:e.score||100})]}),(0,S.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[(0,S.jsxs)("div",{className:"bg-blue-50 rounded p-1.5",children:[(0,S.jsx)("p",{className:"font-semibold text-blue-700",children:e.activeTasks}),(0,S.jsx)("p",{className:"text-blue-600",children:"Aktif"})]}),(0,S.jsxs)("div",{className:"bg-green-50 rounded p-1.5",children:[(0,S.jsx)("p",{className:"font-semibold text-green-700",children:e.completedThisWeek}),(0,S.jsx)("p",{className:"text-green-600",children:"Bu Hafta"})]}),(0,S.jsxs)("div",{className:"rounded p-1.5 "+(e.lateTasks>0?"bg-orange-50":"bg-gray-50"),children:[(0,S.jsx)("p",{className:"font-semibold "+(e.lateTasks>0?"text-orange-700":"text-gray-700"),children:e.lateTasks}),(0,S.jsx)("p",{className:e.lateTasks>0?"text-orange-600":"text-gray-600",children:"GeÃ§"})]}),(0,S.jsxs)("div",{className:"rounded p-1.5 "+(e.overdueTasks>0?"bg-red-50":"bg-gray-50"),children:[(0,S.jsx)("p",{className:"font-semibold "+(e.overdueTasks>0?"text-red-700":"text-gray-700"),children:e.overdueTasks}),(0,S.jsx)("p",{className:e.overdueTasks>0?"text-red-600":"text-gray-600",children:"Geciken"})]})]})]},e.id)),(!e||0===e.length)&&(0,S.jsx)("p",{className:"text-gray-500 text-center py-4",children:"HenÃ¼z Ã§alÄ±ÅŸan bulunmuyor."})]})})};var L=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/recommendations",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch recommendations");return(await t.json()).data},H=({severity:e})=>{const a="h-5 w-5";switch(e){case"critical":return(0,S.jsx)(t,{className:`${a} text-red-500`});case"warning":return(0,S.jsx)(s,{className:`${a} text-orange-500`});default:return(0,S.jsx)(f,{className:`${a} text-blue-500`})}},K=e=>{switch(e){case"critical":return"border-red-200 bg-red-50";case"warning":return"border-orange-200 bg-orange-50";default:return"border-blue-200 bg-blue-50"}};const q=()=>{const{data:e,isLoading:t,error:s}=d({queryKey:["ai-recommendations"],queryFn:L,refetchInterval:12e4});return t?(0,S.jsx)(D,{title:"AI Ã–nerileri",padding:"md",children:(0,S.jsx)("div",{className:"flex justify-center py-8",children:(0,S.jsx)(T,{size:"md"})})}):s?(0,S.jsx)(D,{title:"AI Ã–nerileri",padding:"md",children:(0,S.jsx)("p",{className:"text-red-600 text-sm",children:"Ã–neriler yÃ¼klenemedi."})}):(0,S.jsx)(D,{title:"AI Ã–nerileri",subtitle:e?.length?`${e.length} Ã¶neri`:void 0,padding:"md",children:(0,S.jsxs)("div",{className:"space-y-3 max-h-[350px] overflow-y-auto",children:[e?.map((e,t)=>(0,S.jsx)("div",{className:`p-3 rounded-lg border ${K(e.severity)}`,children:(0,S.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,S.jsx)(H,{severity:e.severity}),(0,S.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,S.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.title}),(0,S.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.description}),e.affectedUsers&&e.affectedUsers.length>0&&(0,S.jsxs)("div",{className:"mt-2",children:[(0,S.jsx)("p",{className:"text-xs text-gray-500",children:"Etkilenen kiÅŸiler:"}),(0,S.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.affectedUsers.slice(0,5).map((e,t)=>(0,S.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-white/50 text-gray-700",children:e},t)),e.affectedUsers.length>5&&(0,S.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.affectedUsers.length-5," daha"]})]})]})]})]})},t)),(!e||0===e.length)&&(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)(b,{className:"h-12 w-12 text-green-400 mx-auto mb-3"}),(0,S.jsx)("p",{className:"text-gray-600 font-medium",children:"Her ÅŸey yolunda!"}),(0,S.jsx)("p",{className:"text-gray-500 text-sm",children:"Åžu an iÃ§in Ã¶neri bulunmuyor."})]})]})})};var R=g(),U={title:"",description:"",deadline_date:"",reminder_date:"",priority:"medium",category:""};const V=()=>{const{user:e,isAdmin:t}=y(),r=w(),[d,c]=(0,R.useState)([]),[x,p]=(0,R.useState)(!0),[g,f]=(0,R.useState)(!1),[b,k]=(0,R.useState)(!1),[T,_]=(0,R.useState)(!1),[D,$]=(0,R.useState)(null),[C,z]=(0,R.useState)(U),[A,E]=(0,R.useState)(""),G=(0,R.useRef)(null),B=(0,R.useRef)(null),Y="http://localhost:3001";(0,R.useEffect)(()=>{M()},[e,t,g]);const I=async()=>{const{data:{session:e}}=await N.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${e?.access_token}`}},M=async()=>{try{p(!0);const e=await I();let t=`${Y}/api/deadlines?limit=100`;g||(t+="&is_completed=false");const s=await(await fetch(t,{headers:e})).json();s.data&&c(s.data.sort((e,t)=>new Date(e.deadline_date).getTime()-new Date(t.deadline_date).getTime()))}catch(e){}finally{p(!1)}},O=e=>{if(B.current){const t=300;B.current.scrollBy({left:"left"===e?-t:t,behavior:"smooth"})}},P={critical:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-blue-500"};return x?(0,S.jsx)("div",{className:"glass-card p-6",children:(0,S.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,S.jsx)("div",{className:"h-6 bg-slate-700 rounded w-1/3"}),(0,S.jsx)("div",{className:"flex gap-4 overflow-hidden",children:[1,2,3,4].map(e=>(0,S.jsx)("div",{className:"w-44 h-32 bg-slate-700 rounded-xl shrink-0"},e))})]})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"glass-card p-6",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,S.jsxs)("div",{className:"flex items-center gap-3",children:[(0,S.jsx)("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl",children:(0,S.jsx)(v,{className:"w-5 h-5 text-white"})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Deadline Takvimi"}),(0,S.jsxs)("p",{className:"text-sm text-slate-400",children:[d.length," deadline â€¢ SaÄŸa kaydÄ±r â†’"]})]})]}),(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[(0,S.jsx)("button",{onClick:()=>f(!g),className:"px-3 py-1.5 text-xs rounded-lg transition-all "+(g?"bg-green-600 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:g?"âœ“ Tamamlananlar":"Aktif"}),(0,S.jsx)("button",{onClick:()=>_(!0),className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-all",title:"CSV Ä°Ã§e Aktar",children:(0,S.jsx)(o,{className:"w-4 h-4"})}),(0,S.jsx)("button",{onClick:async()=>{try{const e=await I(),t=await(await fetch(`${Y}/api/deadlines/export`,{headers:e})).json();if(t.data){const e=["deadline_date,reminder_date,title,description,priority,category",...t.data.map(e=>`${e.deadline_date},${e.reminder_date||""},${e.title.replace(/,/g,";")},${(e.description||"").replace(/,/g,";")},${e.priority},${e.category||""}`)].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download=`deadlines_${(new Date).toISOString().split("T")[0]}.csv`,a.click(),r.success("CSV indirildi")}}catch(e){r.error("DÄ±ÅŸa aktarma hatasÄ±")}},className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-all",title:"CSV DÄ±ÅŸa Aktar",children:(0,S.jsx)(l,{className:"w-4 h-4"})}),(0,S.jsx)("button",{onClick:()=>{$(null),z(U),k(!0)},className:"p-2 text-white bg-purple-600 hover:bg-purple-500 rounded-lg transition-all",title:"Yeni Deadline",children:(0,S.jsx)(u,{className:"w-4 h-4"})})]})]}),0===d.length?(0,S.jsxs)("div",{className:"text-center py-12",children:[(0,S.jsx)(v,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),(0,S.jsx)("p",{className:"text-slate-400 text-lg",children:"HenÃ¼z deadline yok"}),(0,S.jsx)("button",{onClick:()=>k(!0),className:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-500 transition-all",children:"+ Ä°lk Deadline'Ä± Ekle"})]}):(0,S.jsxs)("div",{className:"relative",children:[(0,S.jsx)("button",{onClick:()=>O("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 z-10 p-2 bg-slate-800/90 hover:bg-slate-700 rounded-full shadow-lg transition-all",children:(0,S.jsx)(n,{className:"w-5 h-5 text-white"})}),(0,S.jsx)("button",{onClick:()=>O("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 z-10 p-2 bg-slate-800/90 hover:bg-slate-700 rounded-full shadow-lg transition-all",children:(0,S.jsx)(i,{className:"w-5 h-5 text-white"})}),(0,S.jsx)("div",{ref:B,className:"flex gap-4 overflow-x-auto pb-4 px-8 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent",style:{scrollbarWidth:"thin"},children:d.map(e=>{const t=(e=>{const t=new Date;t.setHours(0,0,0,0);const s=new Date(e);s.setHours(0,0,0,0);const a=s.getTime()-t.getTime();return Math.ceil(a/864e5)})(e.deadline_date),l=(e=>{const t=new Date(e);return{day:t.getDate(),month:t.toLocaleDateString("tr-TR",{month:"short"}),weekday:t.toLocaleDateString("tr-TR",{weekday:"short"})}})(e.deadline_date),i=((e,t)=>t?"from-green-500 to-emerald-600":e<=0?"from-red-500 to-rose-600":e<=2?"from-orange-500 to-amber-600":e<=5?"from-yellow-500 to-amber-500":"from-blue-500 to-indigo-600")(t,e.is_completed),n=((e,t)=>t?"border-green-500/50":e<=0?"border-red-500/50":e<=2?"border-orange-500/50":e<=5?"border-yellow-500/50":"border-blue-500/50")(t,e.is_completed);return(0,S.jsxs)("div",{className:"relative shrink-0 w-48 group",children:[(0,S.jsx)("div",{className:`absolute -top-1 left-1/2 -translate-x-1/2 z-10 px-3 py-1 bg-gradient-to-r ${i} rounded-full shadow-lg`,children:(0,S.jsxs)("div",{className:"flex items-center gap-1 text-white text-xs font-bold",children:[(0,S.jsx)("span",{children:l.day}),(0,S.jsx)("span",{children:l.month})]})}),(0,S.jsxs)("div",{className:`mt-4 p-4 pt-6 rounded-xl border-2 ${n} bg-slate-800/50 backdrop-blur hover:bg-slate-800/80 transition-all h-36`,children:[(0,S.jsx)("div",{className:`absolute top-6 right-3 w-2 h-2 rounded-full ${P[e.priority]}`,title:e.priority}),(0,S.jsx)("h4",{className:"font-semibold text-sm leading-tight line-clamp-2 mb-2 "+(e.is_completed?"text-slate-400 line-through":"text-white"),children:e.title}),(0,S.jsxs)("div",{className:"space-y-1",children:[e.category&&(0,S.jsx)("span",{className:"inline-block px-2 py-0.5 bg-slate-700 rounded text-xs text-slate-300",children:e.category}),(0,S.jsx)("div",{className:"text-xs",children:e.is_completed?(0,S.jsxs)("span",{className:"text-green-400 flex items-center gap-1",children:[(0,S.jsx)(a,{className:"w-3 h-3"}),"TamamlandÄ±"]}):t<=0?(0,S.jsxs)("span",{className:"text-red-400 flex items-center gap-1",children:[(0,S.jsx)(s,{className:"w-3 h-3"}),0===t?"BugÃ¼n!":`${Math.abs(t)} gÃ¼n geÃ§ti`]}):1===t?(0,S.jsx)("span",{className:"text-orange-400",children:"YarÄ±n"}):(0,S.jsxs)("span",{className:"text-slate-400",children:[t," gÃ¼n kaldÄ±"]})})]}),(0,S.jsxs)("div",{className:"absolute bottom-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,S.jsx)("button",{onClick:()=>(async e=>{try{const t=await I();(await fetch(`${Y}/api/deadlines/${e.id}`,{method:"PUT",headers:t,body:JSON.stringify({is_completed:!e.is_completed,completed_at:e.is_completed?null:(new Date).toISOString()})})).ok&&(r.success(e.is_completed?"Tekrar aÃ§Ä±ldÄ±":"TamamlandÄ±"),M())}catch(t){}})(e),className:"p-1 rounded transition-all "+(e.is_completed?"bg-green-500/20 text-green-400":"bg-slate-700 text-slate-400 hover:text-green-400"),title:e.is_completed?"Tekrar aÃ§":"Tamamla",children:(0,S.jsx)(a,{className:"w-3.5 h-3.5"})}),(0,S.jsx)("button",{onClick:()=>(e=>{$(e),z({title:e.title,description:e.description||"",deadline_date:e.deadline_date,reminder_date:e.reminder_date||"",priority:e.priority,category:e.category||""}),k(!0)})(e),className:"p-1 bg-slate-700 text-slate-400 hover:text-white rounded transition-all",title:"DÃ¼zenle",children:(0,S.jsx)(m,{className:"w-3.5 h-3.5"})}),(0,S.jsx)("button",{onClick:()=>(async e=>{if(confirm("Bu deadline'Ä± silmek istediÄŸinize emin misiniz?"))try{const t=await I();(await fetch(`${Y}/api/deadlines/${e}`,{method:"DELETE",headers:t})).ok?(r.success("Deadline silindi"),M()):r.error("Silinemedi")}catch(t){}})(e.id),className:"p-1 bg-slate-700 text-slate-400 hover:text-red-400 rounded transition-all",title:"Sil",children:(0,S.jsx)(h,{className:"w-3.5 h-3.5"})})]})]}),(0,S.jsx)("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full h-4 w-0.5 bg-gradient-to-b from-slate-600 to-transparent"})]},e.id)})}),(0,S.jsx)("div",{className:"absolute bottom-0 left-8 right-8 h-0.5 bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 rounded-full"})]})]}),b&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,S.jsxs)("div",{className:"glass-card w-full max-w-lg p-6",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,S.jsx)("h2",{className:"text-xl font-bold text-white",children:D?"Deadline DÃ¼zenle":"Yeni Deadline"}),(0,S.jsx)("button",{onClick:()=>{k(!1),$(null),z(U)},className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700",children:(0,S.jsx)(j,{className:"h-5 w-5"})})]}),(0,S.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),C.title&&C.deadline_date)try{const e=await I(),t=D?`${Y}/api/deadlines/${D.id}`:`${Y}/api/deadlines`,s=await fetch(t,{method:D?"PUT":"POST",headers:e,body:JSON.stringify(C)}),a=await s.json();s.ok?(r.success(D?"Deadline gÃ¼ncellendi":"Deadline oluÅŸturuldu"),k(!1),$(null),z(U),M()):r.error(a.message||"Hata oluÅŸtu")}catch(t){r.error("Deadline kaydedilemedi")}else r.error("BaÅŸlÄ±k ve tarih zorunludur")},className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"BaÅŸlÄ±k *"}),(0,S.jsx)("input",{type:"text",value:C.title,onChange:e=>z({...C,title:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Deadline baÅŸlÄ±ÄŸÄ±",required:!0})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"AÃ§Ä±klama"}),(0,S.jsx)("textarea",{value:C.description,onChange:e=>z({...C,description:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",rows:2,placeholder:"Opsiyonel aÃ§Ä±klama..."})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Son Tarih *"}),(0,S.jsx)("input",{type:"date",value:C.deadline_date,onChange:e=>z({...C,deadline_date:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"HatÄ±rlatma"}),(0,S.jsx)("input",{type:"date",value:C.reminder_date,onChange:e=>z({...C,reminder_date:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Ã–ncelik"}),(0,S.jsxs)("select",{value:C.priority,onChange:e=>z({...C,priority:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,S.jsx)("option",{value:"low",children:"DÃ¼ÅŸÃ¼k"}),(0,S.jsx)("option",{value:"medium",children:"Orta"}),(0,S.jsx)("option",{value:"high",children:"YÃ¼ksek"}),(0,S.jsx)("option",{value:"critical",children:"Kritik"})]})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Kategori"}),(0,S.jsx)("input",{type:"text",value:C.category,onChange:e=>z({...C,category:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ã–r: ToplantÄ±, Ã–deme..."})]})]}),(0,S.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,S.jsx)("button",{type:"button",onClick:()=>{k(!1),$(null),z(U)},className:"flex-1 px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-all",children:"Ä°ptal"}),(0,S.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-500 hover:to-pink-500 transition-all",children:D?"GÃ¼ncelle":"OluÅŸtur"})]})]})]})}),T&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,S.jsxs)("div",{className:"glass-card w-full max-w-2xl p-6",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,S.jsx)("h2",{className:"text-xl font-bold text-white",children:"CSV Ä°Ã§e Aktar"}),(0,S.jsx)("button",{onClick:()=>{_(!1),E("")},className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700",children:(0,S.jsx)(j,{className:"h-5 w-5"})})]}),(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[(0,S.jsx)("p",{className:"text-sm text-slate-300 mb-2",children:"CSV Format:"}),(0,S.jsx)("code",{className:"text-xs text-purple-400",children:"deadline_date,reminder_date,title,description,priority,category"}),(0,S.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Ã–rnek: 2026-02-15,2026-02-10,Vergi Ã–demesi,AÃ§Ä±klama,high,Finans"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Dosya YÃ¼kle veya YapÄ±ÅŸtÄ±r"}),(0,S.jsx)("input",{ref:G,type:"file",accept:".csv,.txt",onChange:e=>{const t=e.target.files?.[0];if(t){const e=new FileReader;e.onload=e=>{E(e.target?.result)},e.readAsText(t)}},className:"mb-3 w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"}),(0,S.jsx)("textarea",{value:A,onChange:e=>E(e.target.value),className:"w-full h-32 px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"CSV verilerini buraya yapÄ±ÅŸtÄ±rÄ±n..."})]}),(0,S.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,S.jsx)("button",{onClick:()=>{_(!1),E("")},className:"flex-1 px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-all",children:"Ä°ptal"}),(0,S.jsx)("button",{onClick:async()=>{if(A.trim())try{const e=A.trim().split("\n"),t=(e[0].toLowerCase().includes("deadline_date")||e[0].toLowerCase().includes("title")?e.slice(1):e).map(e=>{const[t,s,a,l,r,i]=e.split(",").map(e=>e.trim());return{deadline_date:t,reminder_date:s||null,title:a,description:l||null,priority:r||"medium",category:i||null}}).filter(e=>e.title&&e.deadline_date);if(0===t.length)return void r.error("GeÃ§erli veri bulunamadÄ±");const s=await I(),a=await fetch(`${Y}/api/deadlines/import`,{method:"POST",headers:s,body:JSON.stringify({deadlines:t})}),l=await a.json();a.ok?(r.success(`${t.length} deadline iÃ§e aktarÄ±ldÄ±`),_(!1),E(""),M()):r.error(l.message||"Ä°Ã§e aktarma hatasÄ±")}catch(e){r.error("Ä°Ã§e aktarma hatasÄ±")}else r.error("CSV verisi giriniz")},className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-500 hover:to-pink-500 transition-all",children:"Ä°Ã§e Aktar"})]})]})]})})]})};var J={title:"",description:"",due_date:"",priority:"medium"};const W=()=>{const{user:e}=y(),t=w(),[s,l]=(0,R.useState)([]),[r,i]=(0,R.useState)(!0),[n,d]=(0,R.useState)(!1),[c,o]=(0,R.useState)(!1),[x,g]=(0,R.useState)(null),[f,b]=(0,R.useState)(J),v="http://localhost:3001";(0,R.useEffect)(()=>{T()},[e,n]);const k=async()=>{const{data:{session:e}}=await N.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${e?.access_token}`}},T=async()=>{try{i(!0);const e=await k();let t=`${v}/api/todos?limit=100`;n||(t+="&is_completed=false");const s=await(await fetch(t,{headers:e})).json();s.data&&l(s.data)}catch(e){}finally{i(!1)}},_={low:"bg-blue-500/20 text-blue-400",medium:"bg-yellow-500/20 text-yellow-400",high:"bg-red-500/20 text-red-400"},D={low:"DÃ¼ÅŸÃ¼k",medium:"Orta",high:"YÃ¼ksek"};return r?(0,S.jsx)("div",{className:"glass-card p-6",children:(0,S.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,S.jsx)("div",{className:"h-5 bg-slate-700 rounded w-1/3"}),(0,S.jsx)("div",{className:"h-10 bg-slate-700 rounded"}),(0,S.jsx)("div",{className:"h-10 bg-slate-700 rounded"})]})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"glass-card p-6",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,S.jsxs)("div",{className:"flex items-center gap-3",children:[(0,S.jsx)("div",{className:"p-2 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl",children:(0,S.jsx)(p,{className:"w-5 h-5 text-white"})}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h3",{className:"text-lg font-semibold text-white",children:"KiÅŸisel YapÄ±lacaklar"}),(0,S.jsxs)("p",{className:"text-sm text-slate-400",children:[s.length," Ã¶ÄŸe"]})]})]}),(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[(0,S.jsx)("button",{onClick:()=>d(!n),className:"px-3 py-1.5 text-xs rounded-lg transition-all "+(n?"bg-emerald-600 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:n?"âœ“ TÃ¼mÃ¼":"Aktif"}),(0,S.jsx)("button",{onClick:()=>{g(null),b(J),o(!0)},className:"p-2 text-white bg-emerald-600 hover:bg-emerald-500 rounded-lg transition-all",title:"Yeni Ekle",children:(0,S.jsx)(u,{className:"w-4 h-4"})})]})]}),0===s.length?(0,S.jsxs)("div",{className:"text-center py-8",children:[(0,S.jsx)(p,{className:"w-12 h-12 text-slate-600 mx-auto mb-3"}),(0,S.jsx)("p",{className:"text-slate-400",children:"HenÃ¼z yapÄ±lacak Ã¶ÄŸe yok"}),(0,S.jsx)("button",{onClick:()=>o(!0),className:"mt-3 text-sm text-emerald-400 hover:text-emerald-300",children:"+ Ä°lk Ã¶ÄŸeyi ekle"})]}):(0,S.jsx)("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:s.map(e=>(0,S.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg border transition-all "+(e.is_completed?"bg-slate-800/30 border-slate-700/50":"bg-slate-800/50 border-slate-700 hover:border-slate-600"),children:[(0,S.jsx)("button",{onClick:()=>(async e=>{try{const s=await k();(await fetch(`${v}/api/todos/${e.id}`,{method:"PUT",headers:s,body:JSON.stringify({is_completed:!e.is_completed})})).ok&&(t.success(e.is_completed?"Tekrar aÃ§Ä±ldÄ±":"TamamlandÄ±"),T())}catch(s){}})(e),className:"shrink-0 p-1 rounded transition-all "+(e.is_completed?"bg-emerald-500/20 text-emerald-400":"bg-slate-700 text-slate-400 hover:text-emerald-400"),children:(0,S.jsx)(a,{className:"w-5 h-5"})}),(0,S.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,S.jsx)("p",{className:"font-medium truncate "+(e.is_completed?"text-slate-500 line-through":"text-white"),children:e.title}),e.due_date&&(0,S.jsx)("p",{className:"text-xs text-slate-500",children:new Date(e.due_date).toLocaleDateString("tr-TR")})]}),(0,S.jsx)("span",{className:`shrink-0 px-2 py-0.5 text-xs rounded ${_[e.priority]}`,children:D[e.priority]}),(0,S.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,S.jsx)("button",{onClick:()=>(e=>{g(e),b({title:e.title,description:e.description||"",due_date:e.due_date||"",priority:e.priority}),o(!0)})(e),className:"p-1 text-slate-400 hover:text-white rounded transition-all",children:(0,S.jsx)(m,{className:"w-4 h-4"})}),(0,S.jsx)("button",{onClick:()=>(async e=>{if(confirm("Bu Ã¶ÄŸeyi silmek istediÄŸinize emin misiniz?"))try{const s=await k();(await fetch(`${v}/api/todos/${e}`,{method:"DELETE",headers:s})).ok?(t.success("Silindi"),T()):t.error("Silinemedi")}catch(s){}})(e.id),className:"p-1 text-slate-400 hover:text-red-400 rounded transition-all",children:(0,S.jsx)(h,{className:"w-4 h-4"})})]})]},e.id))})]}),c&&(0,S.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,S.jsxs)("div",{className:"glass-card w-full max-w-md p-6",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,S.jsx)("h2",{className:"text-xl font-bold text-white",children:x?"DÃ¼zenle":"Yeni Ekle"}),(0,S.jsx)("button",{onClick:()=>{o(!1),g(null),b(J)},className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700",children:(0,S.jsx)(j,{className:"h-5 w-5"})})]}),(0,S.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),f.title.trim())try{const e=await k(),s=x?`${v}/api/todos/${x.id}`:`${v}/api/todos`,a=await fetch(s,{method:x?"PUT":"POST",headers:e,body:JSON.stringify({title:f.title,description:f.description||null,due_date:f.due_date||null,priority:f.priority})});if(a.ok)t.success(x?"GÃ¼ncellendi":"Eklendi"),o(!1),g(null),b(J),T();else{const e=await a.json();t.error(e.message||"Hata oluÅŸtu")}}catch(s){t.error("Kaydetme hatasÄ±")}else t.error("BaÅŸlÄ±k zorunludur")},className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"BaÅŸlÄ±k *"}),(0,S.jsx)("input",{type:"text",value:f.title,onChange:e=>b({...f,title:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Ne yapÄ±lacak?",required:!0})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"AÃ§Ä±klama"}),(0,S.jsx)("textarea",{value:f.description,onChange:e=>b({...f,description:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none",rows:2,placeholder:"Detaylar..."})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Tarih"}),(0,S.jsx)("input",{type:"date",value:f.due_date,onChange:e=>b({...f,due_date:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Ã–ncelik"}),(0,S.jsxs)("select",{value:f.priority,onChange:e=>b({...f,priority:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[(0,S.jsx)("option",{value:"low",children:"DÃ¼ÅŸÃ¼k"}),(0,S.jsx)("option",{value:"medium",children:"Orta"}),(0,S.jsx)("option",{value:"high",children:"YÃ¼ksek"})]})]})]}),(0,S.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,S.jsx)("button",{type:"button",onClick:()=>{o(!1),g(null),b(J)},className:"flex-1 px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600 transition-all",children:"Ä°ptal"}),(0,S.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-lg hover:from-emerald-500 hover:to-teal-500 transition-all",children:x?"GÃ¼ncelle":"Ekle"})]})]})]})})]})};var Q=async()=>{const{data:{session:e}}=await N.auth.getSession();if(!e)throw new Error("No active session");const t=await fetch("http://localhost:3001/api/analytics/dashboard",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!t.ok)throw new Error("Failed to fetch dashboard metrics");return(await t.json()).data};const Z=()=>{const{user:e,isAdmin:t}=y(),{data:s,isLoading:a,error:l}=d({queryKey:["dashboard-metrics"],queryFn:Q,refetchInterval:6e4,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)}),i={totalTasks:s?.tasks.total||0,completedTasks:s?.tasks.completed||0,pendingIssues:s?.issues.pending||0,overdueTasks:s?.tasks.overdue||0},n=[{id:"1",type:"task_completed",title:"GÃ¶rev TamamlandÄ±",description:"AylÄ±k rapor hazÄ±rlama gÃ¶revi tamamlandÄ±",timestamp:new Date(Date.now()-18e5).toISOString(),user:{name:e?.profile?.full_name||"KullanÄ±cÄ±"}},{id:"2",type:"issue_reported",title:"Yeni Sorun Bildirildi",description:"YazÄ±cÄ± baÄŸlantÄ± sorunu bildirildi",timestamp:new Date(Date.now()-72e5).toISOString(),user:{name:"Ahmet YÄ±lmaz"}},{id:"3",type:"task_created",title:"Yeni GÃ¶rev OluÅŸturuldu",description:"HaftalÄ±k toplantÄ± notlarÄ± hazÄ±rlama",timestamp:new Date(Date.now()-18e6).toISOString(),user:{name:"AyÅŸe Demir"}}];return(0,S.jsx)(_,{children:a?(0,S.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,S.jsx)(T,{size:"lg",message:"YÃ¼kleniyor..."})}):l?(0,S.jsx)("div",{className:"glass-card p-4 border-red-500/20",children:(0,S.jsx)("p",{className:"text-red-400",children:"Metrikler yÃ¼klenirken bir hata oluÅŸtu."})}):(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:["HoÅŸ Geldiniz, ",(0,S.jsx)("span",{className:"gradient-text",children:e?.profile?.full_name||e?.email?.split("@")[0]}),"!"]}),(0,S.jsx)("p",{className:"mt-2 text-slate-400",children:t?"ðŸ“Š YÃ¶netici Paneli":"ðŸ“‹ GÃ¶rev YÃ¶netim Sistemi"})]}),(0,S.jsxs)(c,{to:"/analytics",className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 hover:-translate-y-0.5 transition-all duration-200 [&>svg]:w-5 [&>svg]:h-5",children:[(0,S.jsx)(r,{className:"h-5 w-5"}),"DetaylÄ± Analitik"]})]}),(0,S.jsx)(C,{stats:i}),(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,S.jsx)(G,{}),(0,S.jsx)(M,{})]}),t&&(0,S.jsx)(Y,{}),(0,S.jsx)(V,{}),(0,S.jsx)(W,{}),t&&(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,S.jsx)(F,{}),(0,S.jsx)(q,{})]}),(0,S.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,S.jsx)("div",{className:"lg:col-span-2",children:(0,S.jsx)(z,{activities:n,maxItems:5})}),(0,S.jsx)("div",{children:(0,S.jsx)(D,{title:"HÄ±zlÄ± Bilgiler",padding:"md",children:(0,S.jsxs)("div",{className:"space-y-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Email"}),(0,S.jsx)("p",{className:"text-base font-medium text-white",children:e?.email})]}),e?.profile?.department&&(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Departman"}),(0,S.jsx)("p",{className:"text-base font-medium text-white",children:e.profile.department})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Rol"}),(0,S.jsx)("p",{className:"text-base font-medium text-white",children:t?"YÃ¶netici":"Ã‡alÄ±ÅŸan"})]}),(0,S.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,S.jsx)("p",{className:"text-sm text-slate-400",children:"Hesap Durumu"}),(0,S.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 mt-1",children:"Aktif"})]}),s&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,S.jsx)("p",{className:"text-sm text-slate-400 mb-2",children:"GÃ¶rev Tamamlama OranÄ±"}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:(0,S.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:`${s.tasks.completionRate}%`}})}),(0,S.jsxs)("span",{className:"ml-2 text-sm font-medium text-white",children:[s.tasks.completionRate,"%"]})]})]}),(0,S.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,S.jsx)("p",{className:"text-sm text-slate-400 mb-2",children:"GÃ¶rev Durumu"}),(0,S.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,S.jsxs)("div",{className:"flex justify-between",children:[(0,S.jsx)("span",{className:"text-slate-400",children:"Devam Eden:"}),(0,S.jsx)("span",{className:"font-medium text-white",children:s.tasks.inProgress})]}),(0,S.jsxs)("div",{className:"flex justify-between",children:[(0,S.jsx)("span",{className:"text-slate-400",children:"Tamamlanan:"}),(0,S.jsx)("span",{className:"font-medium text-emerald-400",children:s.tasks.completed})]}),(0,S.jsxs)("div",{className:"flex justify-between",children:[(0,S.jsx)("span",{className:"text-slate-400",children:"Geciken:"}),(0,S.jsx)("span",{className:"font-medium text-red-400",children:s.tasks.overdue})]})]})]})]})]})})})]})]})})};export{Z as Dashboard};