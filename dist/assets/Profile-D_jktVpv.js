import{F as e,R as t,St as a,et as s,jt as r,s as l}from"./react-vendor-2hQaKJT0.js";import"./supabase-vendor-CLitCmdP.js";import{a as i,i as o}from"./index-4_19cBdp.js";import"./NotificationBell-DOonUTZz.js";import{t as n}from"./Layout-Dciw3jEd.js";var d=r(),c=s();const m=()=>{const{user:s}=o(),[r,m]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),[h,x]=(0,d.useState)(null),[f,b]=(0,d.useState)({full_name:"",department:"",email_notifications:!0,push_notifications:!0});(0,d.useEffect)(()=>{s?.profile&&b({full_name:s.profile.full_name,department:s.profile.department||"",email_notifications:s.profile.notification_preferences?.email??!0,push_notifications:s.profile.notification_preferences?.push??!0})},[s]);const g="w-full bg-slate-800 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-slate-500 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed",j="block text-sm font-medium text-slate-300 mb-2";return(0,c.jsx)(n,{children:(0,c.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Profil Ayarları"}),(0,c.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Kişisel bilgilerinizi ve bildirim tercihlerinizi yönetin"})]}),h&&(0,c.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-xl "+("success"===h.type?"bg-emerald-500/10 border border-emerald-500/30 text-emerald-400":"bg-red-500/10 border border-red-500/30 text-red-400"),children:["success"===h.type?(0,c.jsx)(e,{className:"w-5 h-5 flex-shrink-0"}):(0,c.jsx)(l,{className:"w-5 h-5 flex-shrink-0"}),h.text]}),(0,c.jsxs)("div",{className:"glass-card p-6",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Profil Fotoğrafı"}),(0,c.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,c.jsxs)("div",{className:"relative group",children:[s?.profile?.avatar_url?(0,c.jsx)("img",{src:s.profile.avatar_url,alt:"Avatar",className:"h-24 w-24 rounded-xl object-cover border-2 border-white/10"}):(0,c.jsx)("div",{className:"h-24 w-24 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,c.jsx)("span",{className:"text-3xl font-bold text-white",children:s?.profile?.full_name?.charAt(0).toUpperCase()||"?"})}),(0,c.jsx)("label",{htmlFor:"avatar-upload",className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-xl opacity-0 group-hover:opacity-100 cursor-pointer transition-opacity",children:(0,c.jsx)(t,{className:"w-8 h-8 text-white"})}),(0,c.jsx)("input",{id:"avatar-upload",type:"file",accept:"image/*",onChange:async e=>{try{if(p(!0),x(null),!e.target.files||0===e.target.files.length)return;const t=e.target.files[0],a=t.name.split(".").pop(),r=`avatars/${s.id}-${Math.random()}.${a}`,{error:l}=await i.storage.from("avatars").upload(r,t,{upsert:!0});if(l)throw l;const{data:{publicUrl:o}}=i.storage.from("avatars").getPublicUrl(r),{error:n}=await i.from("profiles").update({avatar_url:o,updated_at:(new Date).toISOString()}).eq("id",s.id);if(n)throw n;x({type:"success",text:"Avatar başarıyla yüklendi"}),setTimeout(()=>window.location.reload(),1500)}catch(t){x({type:"error",text:t.message||"Avatar yüklenirken bir hata oluştu"})}finally{p(!1)}},disabled:u,className:"hidden"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"avatar-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-sm font-medium text-white hover:bg-white/10 transition-colors disabled:opacity-50",children:u?"Yükleniyor...":"Fotoğraf Yükle"}),(0,c.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"JPG, PNG veya GIF formatında, maksimum 2MB"})]})]})]}),(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(!0),x(null);try{const{error:e}=await i.from("profiles").update({full_name:f.full_name,department:f.department||null,notification_preferences:{email:f.email_notifications,push:f.push_notifications},updated_at:(new Date).toISOString()}).eq("id",s.id);if(e)throw e;x({type:"success",text:"Profil başarıyla güncellendi"}),setTimeout(()=>window.location.reload(),1500)}catch(t){x({type:"error",text:t.message||"Profil güncellenirken bir hata oluştu"})}finally{m(!1)}},className:"glass-card p-6 space-y-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"full_name",className:j,children:"Ad Soyad"}),(0,c.jsx)("input",{type:"text",id:"full_name",value:f.full_name,onChange:e=>b({...f,full_name:e.target.value}),className:g,required:!0})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"email",className:j,children:"Email"}),(0,c.jsx)("input",{type:"email",id:"email",value:s?.email||"",disabled:!0,className:`${g} bg-slate-900 text-slate-500`}),(0,c.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Email adresi değiştirilemez"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"department",className:j,children:"Departman"}),(0,c.jsx)("input",{type:"text",id:"department",value:f.department,onChange:e=>b({...f,department:e.target.value}),className:g,placeholder:"Opsiyonel"})]}),(0,c.jsxs)("div",{className:"pt-6 border-t border-white/10",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Bildirim Tercihleri"}),(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group",children:[(0,c.jsx)("input",{type:"checkbox",checked:f.email_notifications,onChange:e=>b({...f,email_notifications:e.target.checked}),className:"w-5 h-5 rounded border-white/20 bg-slate-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0 focus:ring-offset-slate-900"}),(0,c.jsx)("span",{className:"text-sm text-slate-300 group-hover:text-white transition-colors",children:"Email bildirimleri"})]}),(0,c.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer group",children:[(0,c.jsx)("input",{type:"checkbox",checked:f.push_notifications,onChange:e=>b({...f,push_notifications:e.target.checked}),className:"w-5 h-5 rounded border-white/20 bg-slate-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0 focus:ring-offset-slate-900"}),(0,c.jsx)("span",{className:"text-sm text-slate-300 group-hover:text-white transition-colors",children:"Push bildirimleri"})]})]})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-3 pt-6",children:[(0,c.jsx)(a,{to:"/dashboard",className:"px-4 py-2.5 rounded-lg text-sm font-medium text-slate-300 hover:text-white hover:bg-white/5 transition-colors",children:"İptal"}),(0,c.jsx)("button",{type:"submit",disabled:r,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white text-sm font-semibold rounded-lg hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:r?"Kaydediliyor...":"Kaydet"})]})]})]})})};export{m as ProfilePage};