import{n as e}from"./rolldown-runtime-A1xW-pDA.js";import{P as t,V as s,ht as a,mt as l,vt as i}from"./react-vendor-BrW68ebb.js";import{i as r,n,t as d}from"./index-BngHtetc.js";import{n as o,t as c}from"./Layout-DFNvthLu.js";import{t as m}from"./Modal-VQNNPo-d.js";var x=e(i(),1),u=s();(0,x.forwardRef)(({children:e,variant:t="primary",size:s="md",fullWidth:a=!1,haptic:l=!0,hapticType:i="light",className:r="",onClick:n,disabled:d,...c},m)=>{const x=a?"w-full":"";return(0,u.jsx)("button",{ref:m,className:`font-medium rounded-lg transition-all duration-200 active:scale-95 touch-manipulation ${{primary:"bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 disabled:bg-blue-300",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 active:bg-gray-400 disabled:bg-gray-100",danger:"bg-red-600 text-white hover:bg-red-700 active:bg-red-800 disabled:bg-red-300",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 active:bg-gray-200 disabled:text-gray-400"}[t]} ${{sm:"px-3 py-2 text-sm min-h-[36px]",md:"px-4 py-2.5 text-base min-h-[44px]",lg:"px-6 py-3 text-lg min-h-[52px]"}[s]} ${x} ${r} disabled:cursor-not-allowed disabled:opacity-50`,onClick:e=>{l&&!d&&o(i),n&&n(e)},disabled:d,...c,children:e})}).displayName="TouchButton";var h={not_started:"Başlamadı",in_progress:"Devam Ediyor",completed:"Tamamlandı",blocked:"Engellendi"},p={not_started:"bg-slate-500/20 text-slate-300",in_progress:"bg-blue-500/20 text-blue-400",completed:"bg-emerald-500/20 text-emerald-400",blocked:"bg-red-500/20 text-red-400"},b={low:"Düşük",medium:"Orta",high:"Yüksek",critical:"Kritik"},g={low:"bg-slate-500/20 text-slate-300",medium:"bg-blue-500/20 text-blue-400",high:"bg-orange-500/20 text-orange-400",critical:"bg-red-500/20 text-red-400"},j={routine:"Rutin",project:"Proje",one_time:"Tek Seferlik",issue_resolution:"Sorun Çözümü"};const f=()=>{const{id:e}=a(),s=l(),[i,o]=(0,x.useState)(null),[f,v]=(0,x.useState)(!0),[N,y]=(0,x.useState)(null),[w,k]=(0,x.useState)(!1),[_,C]=(0,x.useState)(!1),[G,S]=(0,x.useState)(!1),[D,T]=(0,x.useState)(!1),[E,$]=(0,x.useState)("not_started"),[z,B]=(0,x.useState)(0),[O,R]=(0,x.useState)(0);(0,x.useEffect)(()=>{e&&A()},[e]);const A=async()=>{try{v(!0),y(null);const{data:{session:t}}=await r.auth.getSession();if(!t)return void y("Oturum bulunamadı");const s=await fetch(`http://localhost:3001/api/tasks/${e}`,{headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Görev yüklenemedi");const a=await s.json();o(a.data),$(a.data.status),B(a.data.progress_percentage),R(a.data.actual_hours||0)}catch(t){y(t instanceof Error?t.message:"Bir hata oluştu")}finally{v(!1)}},L=async t=>{try{k(!0);const{data:{session:s}}=await r.auth.getSession();if(!s)throw new Error("Oturum bulunamadı");const a=await fetch(`http://localhost:3001/api/tasks/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error("Görev güncellenemedi");return o((await a.json()).data),!0}catch(s){return alert(s instanceof Error?s.message:"Güncelleme başarısız"),!1}finally{k(!1)}};if(f)return(0,u.jsx)(c,{children:(0,u.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,u.jsx)(d,{size:"lg",message:"Görev yükleniyor..."})})});if(N||!i)return(0,u.jsx)(c,{children:(0,u.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,u.jsxs)("div",{className:"glass-card p-6 rounded-xl border-red-500/30",children:[(0,u.jsx)("p",{className:"font-medium text-red-400",children:"Hata"}),(0,u.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:N||"Görev bulunamadı"}),(0,u.jsx)("button",{onClick:()=>s("/tasks"),className:"mt-4 text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"← Görevlere Dön"})]})})});const P=i.due_date&&new Date(i.due_date)<new Date&&"completed"!==i.status;return(0,u.jsxs)(c,{children:[(0,u.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,u.jsxs)("button",{onClick:()=>s("/tasks"),className:"inline-flex items-center gap-2 text-sm text-slate-400 hover:text-white transition-colors [&>svg]:w-4 [&>svg]:h-4",children:[(0,u.jsx)(t,{className:"h-4 w-4"}),"Görevlere Dön"]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:i.title}),P&&(0,u.jsx)("p",{className:"mt-2 text-sm text-red-400 font-medium",children:"⚠️ Bu görev gecikmiş"})]}),(0,u.jsxs)("div",{className:"glass-card p-6 rounded-xl space-y-6",children:[(0,u.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-sm text-slate-400",children:"Durum:"}),(0,u.jsx)("div",{className:"mt-1",children:(0,u.jsx)("span",{className:n("px-3 py-1 text-sm font-medium rounded-full",p[i.status]),children:h[i.status]})})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-sm text-slate-400",children:"Öncelik:"}),(0,u.jsx)("div",{className:"mt-1",children:(0,u.jsx)("span",{className:n("px-3 py-1 text-sm font-medium rounded-full",g[i.priority]),children:b[i.priority]})})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-sm text-slate-400",children:"Kategori:"}),(0,u.jsx)("div",{className:"mt-1",children:(0,u.jsx)("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-purple-500/20 text-purple-400",children:j[i.category]})})]})]}),i.description&&(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Açıklama"}),(0,u.jsx)("p",{className:"text-slate-400 whitespace-pre-wrap",children:i.description})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,u.jsx)("h3",{className:"text-sm font-medium text-slate-300",children:"İlerleme"}),(0,u.jsx)("button",{onClick:()=>S(!0),className:"text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Güncelle"})]}),(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsx)("div",{className:"flex-1",children:(0,u.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-3 overflow-hidden",children:(0,u.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-3 rounded-full transition-all duration-500",style:{width:`${i.progress_percentage}%`}})})}),(0,u.jsxs)("span",{className:"text-sm font-semibold text-white",children:[i.progress_percentage,"%"]})]})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,u.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg",children:[(0,u.jsx)("h3",{className:"text-sm font-medium text-slate-400 mb-1",children:"Tahmini Süre"}),(0,u.jsxs)("p",{className:"text-2xl font-semibold text-white",children:[i.estimated_hours||0," ",(0,u.jsx)("span",{className:"text-sm text-slate-400",children:"saat"})]})]}),(0,u.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg",children:[(0,u.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,u.jsx)("h3",{className:"text-sm font-medium text-slate-400",children:"Gerçekleşen Süre"}),(0,u.jsx)("button",{onClick:()=>T(!0),className:"text-xs text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Güncelle"})]}),(0,u.jsxs)("p",{className:"text-2xl font-semibold text-white",children:[i.actual_hours||0," ",(0,u.jsx)("span",{className:"text-sm text-slate-400",children:"saat"})]})]})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.due_date&&(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-slate-400",children:"Bitiş Tarihi:"}),(0,u.jsx)("span",{className:n("ml-2 font-medium",P?"text-red-400":"text-white"),children:new Date(i.due_date).toLocaleDateString("tr-TR")})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"text-slate-400",children:"Oluşturulma:"}),(0,u.jsx)("span",{className:"ml-2 font-medium text-white",children:new Date(i.created_at).toLocaleDateString("tr-TR")})]})]}),i.tags&&i.tags.length>0&&(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Etiketler"}),(0,u.jsx)("div",{className:"flex flex-wrap gap-2",children:i.tags.map((e,t)=>(0,u.jsx)("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded-full text-sm",children:e},t))})]}),(0,u.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-white/10",children:[(0,u.jsx)("button",{onClick:()=>C(!0),disabled:w,className:"px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-200 disabled:opacity-50",children:"Durumu Güncelle"}),(0,u.jsx)("button",{onClick:()=>s(`/tasks/${e}/edit`),disabled:w,className:"px-5 py-2.5 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-xl transition-colors disabled:opacity-50",children:"Düzenle"})]})]})]}),(0,u.jsx)(m,{isOpen:_,onClose:()=>C(!1),title:"Durum Güncelle",children:(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Yeni Durum"}),(0,u.jsxs)("select",{value:E,onChange:e=>$(e.target.value),className:"w-full bg-slate-800 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none",children:[(0,u.jsx)("option",{value:"not_started",children:"Başlamadı"}),(0,u.jsx)("option",{value:"in_progress",children:"Devam Ediyor"}),(0,u.jsx)("option",{value:"completed",children:"Tamamlandı"}),(0,u.jsx)("option",{value:"blocked",children:"Engellendi"})]})]}),(0,u.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,u.jsx)("button",{onClick:()=>C(!1),disabled:w,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,u.jsx)("button",{onClick:async()=>{await L({status:E})&&C(!1)},disabled:w,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:w?"Güncelleniyor...":"Güncelle"})]})]})}),(0,u.jsx)(m,{isOpen:G,onClose:()=>S(!1),title:"İlerleme Güncelle",children:(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsxs)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["İlerleme Yüzdesi: ",(0,u.jsxs)("span",{className:"text-white font-semibold",children:[z,"%"]})]}),(0,u.jsx)("input",{type:"range",min:"0",max:"100",value:z,onChange:e=>B(parseInt(e.target.value)),className:"w-full accent-blue-500"})]}),(0,u.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,u.jsx)("button",{onClick:()=>S(!1),disabled:w,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,u.jsx)("button",{onClick:async()=>{await L({progress_percentage:z})&&S(!1)},disabled:w,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:w?"Güncelleniyor...":"Güncelle"})]})]})}),(0,u.jsx)(m,{isOpen:D,onClose:()=>T(!1),title:"Gerçekleşen Süre Güncelle",children:(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Gerçekleşen Süre (saat)"}),(0,u.jsx)("input",{type:"number",min:"0",step:"0.5",value:O,onChange:e=>R(parseFloat(e.target.value)||0),className:"w-full bg-slate-800 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"})]}),(0,u.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,u.jsx)("button",{onClick:()=>T(!1),disabled:w,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,u.jsx)("button",{onClick:async()=>{await L({actual_hours:O})&&T(!1)},disabled:w,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:w?"Güncelleniyor...":"Güncelle"})]})]})})]})};export{f as t};