import{n as e}from"./rolldown-runtime-A1xW-pDA.js";import{Dt as t,Ot as s,et as a,jt as l,q as i}from"./react-vendor-2hQaKJT0.js";import{a as r,r as n,t as d}from"./index-B1OELnp-.js";import{t as o}from"./Layout-3bhG6fzF.js";import{t as c}from"./Modal-DnIZetdV.js";var m=e(l(),1),x=a(),u={not_started:"Başlamadı",in_progress:"Devam Ediyor",completed:"Tamamlandı",blocked:"Engellendi"},h={not_started:"bg-slate-500/20 text-slate-300",in_progress:"bg-blue-500/20 text-blue-400",completed:"bg-emerald-500/20 text-emerald-400",blocked:"bg-red-500/20 text-red-400"},p={low:"Düşük",medium:"Orta",high:"Yüksek",critical:"Kritik"},b={low:"bg-slate-500/20 text-slate-300",medium:"bg-blue-500/20 text-blue-400",high:"bg-orange-500/20 text-orange-400",critical:"bg-red-500/20 text-red-400"},j={routine:"Rutin",project:"Proje",one_time:"Tek Seferlik",issue_resolution:"Sorun Çözümü"};const g=()=>{const{id:e}=s(),a=t(),[l,g]=(0,m.useState)(null),[f,v]=(0,m.useState)(!0),[N,w]=(0,m.useState)(null),[y,k]=(0,m.useState)(!1),[_,G]=(0,m.useState)(!1),[S,C]=(0,m.useState)(!1),[D,E]=(0,m.useState)(!1),[T,O]=(0,m.useState)("not_started"),[z,B]=(0,m.useState)(0),[$,A]=(0,m.useState)(0);(0,m.useEffect)(()=>{e&&L()},[e]);const L=async()=>{try{v(!0),w(null);const{data:{session:t}}=await r.auth.getSession();if(!t)return void w("Oturum bulunamadı");const s=await fetch(`https://rapor-sistemi-backend.onrender.com/api/tasks/${e}`,{headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Görev yüklenemedi");const a=await s.json();g(a.data),O(a.data.status),B(a.data.progress_percentage),A(a.data.actual_hours||0)}catch(t){w(t instanceof Error?t.message:"Bir hata oluştu")}finally{v(!1)}},R=async t=>{try{k(!0);const{data:{session:s}}=await r.auth.getSession();if(!s)throw new Error("Oturum bulunamadı");const a=await fetch(`https://rapor-sistemi-backend.onrender.com/api/tasks/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error("Görev güncellenemedi");return g((await a.json()).data),!0}catch(s){return alert(s instanceof Error?s.message:"Güncelleme başarısız"),!1}finally{k(!1)}};if(f)return(0,x.jsx)(o,{children:(0,x.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,x.jsx)(d,{size:"lg",message:"Görev yükleniyor..."})})});if(N||!l)return(0,x.jsx)(o,{children:(0,x.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,x.jsxs)("div",{className:"glass-card p-6 rounded-xl border-red-500/30",children:[(0,x.jsx)("p",{className:"font-medium text-red-400",children:"Hata"}),(0,x.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:N||"Görev bulunamadı"}),(0,x.jsx)("button",{onClick:()=>a("/tasks"),className:"mt-4 text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"← Görevlere Dön"})]})})});const Y=l.due_date&&new Date(l.due_date)<new Date&&"completed"!==l.status;return(0,x.jsxs)(o,{children:[(0,x.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,x.jsxs)("button",{onClick:()=>a("/tasks"),className:"inline-flex items-center gap-2 text-sm text-slate-400 hover:text-white transition-colors [&>svg]:w-4 [&>svg]:h-4",children:[(0,x.jsx)(i,{className:"h-4 w-4"}),"Görevlere Dön"]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:l.title}),Y&&(0,x.jsx)("p",{className:"mt-2 text-sm text-red-400 font-medium",children:"⚠️ Bu görev gecikmiş"})]}),(0,x.jsxs)("div",{className:"glass-card p-6 rounded-xl space-y-6",children:[(0,x.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-sm text-slate-400",children:"Durum:"}),(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsx)("span",{className:n("px-3 py-1 text-sm font-medium rounded-full",h[l.status]),children:u[l.status]})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-sm text-slate-400",children:"Öncelik:"}),(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsx)("span",{className:n("px-3 py-1 text-sm font-medium rounded-full",b[l.priority]),children:p[l.priority]})})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-sm text-slate-400",children:"Kategori:"}),(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsx)("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-purple-500/20 text-purple-400",children:j[l.category]})})]})]}),l.description&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Açıklama"}),(0,x.jsx)("p",{className:"text-slate-400 whitespace-pre-wrap",children:l.description})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-slate-300",children:"İlerleme"}),(0,x.jsx)("button",{onClick:()=>C(!0),className:"text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Güncelle"})]}),(0,x.jsxs)("div",{className:"flex items-center gap-4",children:[(0,x.jsx)("div",{className:"flex-1",children:(0,x.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-3 overflow-hidden",children:(0,x.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-3 rounded-full transition-all duration-500",style:{width:`${l.progress_percentage}%`}})})}),(0,x.jsxs)("span",{className:"text-sm font-semibold text-white",children:[l.progress_percentage,"%"]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,x.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg",children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-slate-400 mb-1",children:"Tahmini Süre"}),(0,x.jsxs)("p",{className:"text-2xl font-semibold text-white",children:[l.estimated_hours||0," ",(0,x.jsx)("span",{className:"text-sm text-slate-400",children:"saat"})]})]}),(0,x.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg",children:[(0,x.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-slate-400",children:"Gerçekleşen Süre"}),(0,x.jsx)("button",{onClick:()=>E(!0),className:"text-xs text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Güncelle"})]}),(0,x.jsxs)("p",{className:"text-2xl font-semibold text-white",children:[l.actual_hours||0," ",(0,x.jsx)("span",{className:"text-sm text-slate-400",children:"saat"})]})]})]}),(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[l.due_date&&(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-slate-400",children:"Bitiş Tarihi:"}),(0,x.jsx)("span",{className:n("ml-2 font-medium",Y?"text-red-400":"text-white"),children:new Date(l.due_date).toLocaleDateString("tr-TR")})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-slate-400",children:"Oluşturulma:"}),(0,x.jsx)("span",{className:"ml-2 font-medium text-white",children:new Date(l.created_at).toLocaleDateString("tr-TR")})]})]}),l.tags&&l.tags.length>0&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:"Etiketler"}),(0,x.jsx)("div",{className:"flex flex-wrap gap-2",children:l.tags.map((e,t)=>(0,x.jsx)("span",{className:"px-3 py-1 bg-slate-700 text-slate-300 rounded-full text-sm",children:e},t))})]}),(0,x.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-white/10",children:[(0,x.jsx)("button",{onClick:()=>G(!0),disabled:y,className:"px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-200 disabled:opacity-50",children:"Durumu Güncelle"}),(0,x.jsx)("button",{onClick:()=>a(`/tasks/${e}/edit`),disabled:y,className:"px-5 py-2.5 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-xl transition-colors disabled:opacity-50",children:"Düzenle"})]})]})]}),(0,x.jsx)(c,{isOpen:_,onClose:()=>G(!1),title:"Durum Güncelle",children:(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Yeni Durum"}),(0,x.jsxs)("select",{value:T,onChange:e=>O(e.target.value),className:"w-full bg-slate-800 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none",children:[(0,x.jsx)("option",{value:"not_started",children:"Başlamadı"}),(0,x.jsx)("option",{value:"in_progress",children:"Devam Ediyor"}),(0,x.jsx)("option",{value:"completed",children:"Tamamlandı"}),(0,x.jsx)("option",{value:"blocked",children:"Engellendi"})]})]}),(0,x.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,x.jsx)("button",{onClick:()=>G(!1),disabled:y,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,x.jsx)("button",{onClick:async()=>{await R({status:T})&&G(!1)},disabled:y,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:y?"Güncelleniyor...":"Güncelle"})]})]})}),(0,x.jsx)(c,{isOpen:S,onClose:()=>C(!1),title:"İlerleme Güncelle",children:(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["İlerleme Yüzdesi: ",(0,x.jsxs)("span",{className:"text-white font-semibold",children:[z,"%"]})]}),(0,x.jsx)("input",{type:"range",min:"0",max:"100",value:z,onChange:e=>B(parseInt(e.target.value)),className:"w-full accent-blue-500"})]}),(0,x.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,x.jsx)("button",{onClick:()=>C(!1),disabled:y,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,x.jsx)("button",{onClick:async()=>{await R({progress_percentage:z})&&C(!1)},disabled:y,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:y?"Güncelleniyor...":"Güncelle"})]})]})}),(0,x.jsx)(c,{isOpen:D,onClose:()=>E(!1),title:"Gerçekleşen Süre Güncelle",children:(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Gerçekleşen Süre (saat)"}),(0,x.jsx)("input",{type:"number",min:"0",step:"0.5",value:$,onChange:e=>A(parseFloat(e.target.value)||0),className:"w-full bg-slate-800 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"})]}),(0,x.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,x.jsx)("button",{onClick:()=>E(!1),disabled:y,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white transition-colors",children:"İptal"}),(0,x.jsx)("button",{onClick:async()=>{await R({actual_hours:$})&&E(!1)},disabled:y,className:"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg hover:from-blue-500 hover:to-purple-500 transition-all disabled:opacity-50",children:y?"Güncelleniyor...":"Güncelle"})]})]})})]})};export{g as t};