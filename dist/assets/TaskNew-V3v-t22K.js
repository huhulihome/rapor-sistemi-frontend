import{n as t}from"./rolldown-runtime-A1xW-pDA.js";import{J as s,Tt as e,V as a,xt as i}from"./react-vendor-DnbmBACz.js";import"./supabase-vendor-CLitCmdP.js";import{i as r,r as o}from"./index-CDPVztAZ.js";import"./NotificationBell-DpekPiHl.js";import{t as n}from"./Layout-3NCdNaPA.js";import{t as l}from"./TaskForm-m-m6Vi4S.js";var d=t(e(),1),c=s();const m=()=>{const t=i(),{isAdmin:s}=o(),[e,m]=(0,d.useState)(!1);return(0,c.jsx)(n,{children:(0,c.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,c.jsxs)("button",{onClick:()=>t("/tasks"),className:"inline-flex items-center gap-2 text-sm text-slate-400 hover:text-white transition-colors [&>svg]:w-4 [&>svg]:h-4",children:[(0,c.jsx)(a,{className:"h-4 w-4"}),"Görevlere Dön"]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:s?"Yeni Görev Oluştur":"Kendime Görev Ekle"}),(0,c.jsx)("p",{className:"mt-1 text-slate-400",children:s?"Yeni bir görev oluşturun ve istediğiniz kişiye atayın":"Kendinize yeni bir görev oluşturun. Başka birine iş atamak için Sorunlar sayfasını kullanın."})]}),(0,c.jsx)("div",{className:"glass-card p-6 rounded-xl",children:(0,c.jsx)(l,{onSubmit:async s=>{try{m(!0);const{data:{session:e}}=await r.auth.getSession();if(!e)return void alert("Oturum bulunamadı");const a="http://localhost:3001",i={title:s.title,description:s.description,category:s.category,priority:s.priority,assigned_to:s.assigned_to||void 0,due_date:s.due_date||void 0,estimated_hours:s.estimated_hours||void 0,tags:s.tags||[]},o=await fetch(`${a}/api/tasks`,{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(!o.ok){const t=await o.json();throw new Error(t.message||"Görev oluşturulamadı")}t(`/tasks/${(await o.json()).data.id}`)}catch(e){alert(e instanceof Error?e.message:"Görev oluşturulamadı")}finally{m(!1)}},onCancel:()=>t("/tasks"),isLoading:e})})]})})};export{m as TaskNew};