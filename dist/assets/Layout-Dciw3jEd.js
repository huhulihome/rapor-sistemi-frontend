import{D as e,Dt as t,E as s,Et as a,G as i,H as n,L as r,S as l,St as o,a as d,d as c,et as h,i as m,j as x,jt as u,n as f,o as p,r as b,t as w,u as v}from"./react-vendor-2hQaKJT0.js";import{a as g,i as j,r as N}from"./index-4_19cBdp.js";import{t as y}from"./NotificationBell-DOonUTZz.js";var k=u(),A=h();const S=({onMenuClick:e})=>{const{user:t,logout:s,isAdmin:a}=j(),[r,l]=(0,k.useState)([]),[d,c]=(0,k.useState)(0);(0,k.useEffect)(()=>{h();const e=g.channel("notifications-realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},e=>{const s=e.new;s.user_id&&s.user_id!==t?.id||(l(e=>[s,...e.slice(0,19)]),c(e=>e+1))}).subscribe();return()=>{g.removeChannel(e)}},[t?.id]);const h=async()=>{try{const{data:{session:e}}=await g.auth.getSession();if(!e)return;const t=await fetch("http://localhost:3001/api/notifications?limit=10",{headers:{Authorization:`Bearer ${e.access_token}`}});if(t.ok){const e=await t.json();l(e.data?.notifications||[]),c(e.data?.unreadCount||0)}}catch(e){}};return(0,A.jsx)("header",{className:"sticky top-0 z-40 glass-dark border-b border-white/5",children:(0,A.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[(0,A.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,A.jsx)("button",{onClick:e,className:"lg:hidden p-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-200 [&>svg]:w-6 [&>svg]:h-6","aria-label":"Open menu",children:(0,A.jsx)(n,{className:"h-6 w-6"})}),(0,A.jsx)(o,{to:"/dashboard",className:"hidden lg:flex items-center",children:(0,A.jsx)("h1",{className:"text-xl font-bold gradient-text",children:"Modern Office System"})})]}),(0,A.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,A.jsx)(y,{count:d,notifications:r,onMarkRead:async e=>{try{const{data:{session:t}}=await g.auth.getSession();if(!t)return;await fetch(`http://localhost:3001/api/notifications/${e}/read`,{method:"PUT",headers:{Authorization:`Bearer ${t.access_token}`}}),l(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t)),c(e=>Math.max(0,e-1))}catch(t){}},onMarkAllRead:async()=>{try{const{data:{session:e}}=await g.auth.getSession();if(!e)return;await fetch("http://localhost:3001/api/notifications/read-all",{method:"PUT",headers:{Authorization:`Bearer ${e.access_token}`}}),l(e=>e.map(e=>({...e,is_read:!0}))),c(0)}catch(e){}}}),(0,A.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,A.jsxs)("div",{className:"hidden sm:block text-right",children:[(0,A.jsx)("p",{className:"text-sm font-medium text-white",children:t?.profile?.full_name||t?.email?.split("@")[0]}),a&&(0,A.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 text-xs font-semibold text-blue-400 bg-blue-500/10 rounded-full",children:"Admin"})]}),(0,A.jsx)(o,{to:"/profile",className:"w-9 h-9 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-200",children:(t?.profile?.full_name||t?.email||"U")[0].toUpperCase()})]}),(0,A.jsxs)("button",{onClick:async()=>{try{await s()}catch(e){}},className:"hidden sm:inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-200 [&>svg]:w-4 [&>svg]:h-4",children:[(0,A.jsx)(i,{className:"h-4 w-4"}),"Çıkış"]})]})]})})},M=({isOpen:e,onClose:t})=>{const i=a(),{isAdmin:n}=j(),d=[{name:"Dashboard",href:"/dashboard",icon:l,adminOnly:!1},{name:"Görevler",href:"/tasks",icon:x,adminOnly:!1},{name:"Sorunlar",href:"/issues",icon:s,adminOnly:!1},{name:"Analitik",href:"/analytics",icon:r,adminOnly:!1},{name:"Kullanıcılar",href:"/users",icon:v,adminOnly:!0}].filter(e=>!e.adminOnly||n);return(0,A.jsxs)(A.Fragment,{children:[e&&(0,A.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 lg:hidden",onClick:t}),(0,A.jsx)("aside",{className:N("fixed inset-y-0 left-0 z-50 w-64 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:z-auto","bg-gradient-to-b from-slate-900 via-slate-900 to-slate-950","border-r border-white/5",e?"translate-x-0":"-translate-x-full"),children:(0,A.jsxs)("div",{className:"flex flex-col h-full",children:[(0,A.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-white/5",children:[(0,A.jsxs)(o,{to:"/dashboard",className:"flex items-center space-x-3",children:[(0,A.jsx)("div",{className:"w-8 h-8 rounded-lg gradient-primary flex items-center justify-center",children:(0,A.jsx)("span",{className:"text-white font-bold text-sm",children:"MO"})}),(0,A.jsx)("span",{className:"text-lg font-bold text-white",children:"Office"})]}),(0,A.jsx)("button",{onClick:t,className:"lg:hidden p-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors",children:(0,A.jsx)(p,{className:"h-5 w-5"})})]}),(0,A.jsx)("nav",{className:"flex-1 px-3 py-6 space-y-1 overflow-y-auto scrollbar-dark",children:d.map(e=>{const s=i.pathname===e.href;return(0,A.jsxs)(o,{to:e.href,onClick:t,className:N("group flex items-center px-4 py-3 text-sm font-medium rounded-xl transition-all duration-200",s?"bg-gradient-to-r from-blue-500/20 to-purple-500/20 text-white shadow-lg shadow-blue-500/10":"text-slate-400 hover:text-white hover:bg-white/5"),children:[(0,A.jsx)("div",{className:"mr-3 [&>svg]:w-5 [&>svg]:h-5",children:(0,A.jsx)(e.icon,{className:N("h-5 w-5 transition-colors",s?"text-blue-400":"text-slate-500 group-hover:text-slate-300")})}),e.name,s&&(0,A.jsx)("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-blue-400 animate-pulse"})]},e.name)})}),(0,A.jsx)("div",{className:"p-4 border-t border-white/5",children:(0,A.jsxs)("div",{className:"glass rounded-xl p-3",children:[(0,A.jsx)("p",{className:"text-xs text-slate-500 text-center",children:"© 2024 Modern Office"}),(0,A.jsx)("p",{className:"text-xs text-slate-600 text-center mt-1",children:"v1.0.0"})]})})]})})]})},O=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),C=()=>/iPad|Android/i.test(navigator.userAgent)&&!P(),P=()=>/iPhone|Android.*Mobile|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),T=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,z=()=>P()?"mobile":C()?"tablet":"desktop",E=()=>window.innerHeight>window.innerWidth?"portrait":"landscape",_=()=>window.innerWidth<768,B=()=>window.innerWidth>=768&&window.innerWidth<1024,L=()=>window.innerWidth>=1024,W=(e="light")=>{((e=200)=>{"vibrate"in navigator&&navigator.vibrate(e)})({light:10,medium:20,heavy:50}[e])},$=()=>{const s=t(),i=a(),{user:n}=j(),o=[{path:"/dashboard",label:"Ana Sayfa",icon:l,iconActive:f},{path:"/tasks",label:"Görevler",icon:x,iconActive:m},{path:"/issues",label:"Sorunlar",icon:e,iconActive:b},{path:"/analytics",label:"Analiz",icon:r,iconActive:d},{path:"/profile",label:"Profil",icon:c,iconActive:w}];return(0,A.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 glass-dark border-t border-white/5 safe-area-inset-bottom z-40 md:hidden",children:(0,A.jsx)("div",{className:"flex items-center justify-around h-16",children:o.filter(e=>!e.adminOnly||"admin"===n?.profile?.role).map(e=>{const t=i.pathname===e.path,a=t?e.iconActive:e.icon;return(0,A.jsxs)("button",{onClick:()=>{return t=e.path,W("light"),void s(t);var t},className:"flex flex-col items-center justify-center flex-1 h-full transition-all duration-200 touch-manipulation "+(t?"text-blue-400":"text-slate-500 hover:text-slate-300"),children:[(0,A.jsxs)("div",{className:`relative ${t?"scale-110":""} transition-transform`,children:[(0,A.jsx)("div",{className:"[&>svg]:w-6 [&>svg]:h-6",children:(0,A.jsx)(a,{className:"h-6 w-6 mb-1"})}),t&&(0,A.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-blue-400"})]}),(0,A.jsx)("span",{className:"text-xs font-medium "+(t?"text-blue-400":""),children:e.label})]},e.path)})})})},H=({children:e})=>{const[t,s]=(0,k.useState)(!1),{viewport:a}=(()=>{const[e,t]=(0,k.useState)({isMobile:O(),isTablet:C(),isPhone:P(),isTouch:T(),deviceType:z(),orientation:E(),viewport:{isSmall:_(),isMedium:B(),isLarge:L(),width:window.innerWidth,height:window.innerHeight}});return(0,k.useEffect)(()=>{const e=()=>{t({isMobile:O(),isTablet:C(),isPhone:P(),isTouch:T(),deviceType:z(),orientation:E(),viewport:{isSmall:_(),isMedium:B(),isLarge:L(),width:window.innerWidth,height:window.innerHeight}})},s=()=>{setTimeout(e,100)};return window.addEventListener("resize",e),window.addEventListener("orientationchange",s),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",s)}},[]),e})();return(0,A.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:[(0,A.jsx)(S,{onMenuClick:()=>s(!t)}),(0,A.jsxs)("div",{className:"flex",children:[(0,A.jsx)(M,{isOpen:t,onClose:()=>s(!1)}),(0,A.jsx)("main",{className:"flex-1 lg:ml-64",children:(0,A.jsx)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 "+(a.isSmall?"pb-24":""),children:e})})]}),a.isSmall&&(0,A.jsx)($,{})]})};export{W as n,H as t};