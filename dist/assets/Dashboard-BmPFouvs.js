import{C as e,D as s,E as t,V as a,b as r,g as l,h as i,lt as n,w as d,y as c,z as o}from"./react-vendor-BrW68ebb.js";import"./supabase-vendor-CLitCmdP.js";import{i as m,n as x,r as h,t as u}from"./index-BngHtetc.js";import"./NotificationBell-D0CR4O40.js";import{t as p}from"./Layout-DFNvthLu.js";import{t as j}from"./Card-CQwe59rg.js";var f=a();const v=({title:e,value:s,icon:t,trend:a,color:r="blue"})=>{const l="bg-emerald-500/10 text-emerald-400",i="bg-red-500/10 text-red-400";return(0,f.jsx)("div",{className:"stat-card p-6 hover:scale-[1.02] transition-all duration-300 hover:shadow-2xl hover:shadow-blue-500/10",children:(0,f.jsxs)("div",{className:"flex items-start justify-between",children:[(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-sm font-medium text-slate-400 mb-1",children:e}),(0,f.jsx)("p",{className:"text-3xl font-bold text-white tracking-tight",children:s}),a&&(0,f.jsxs)("div",{className:"flex items-center mt-3",children:[(0,f.jsxs)("span",{className:x("inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",a.isPositive?l:i),children:[a.isPositive?"â†‘":"â†“"," ",Math.abs(a.value),"%"]}),(0,f.jsx)("span",{className:"text-xs text-slate-500 ml-2",children:"son aydan"})]})]}),t&&(0,f.jsx)("div",{className:x("flex-shrink-0 w-12 h-12 flex items-center justify-center rounded-xl bg-gradient-to-br shadow-lg",{blue:"from-blue-500 to-blue-600",green:"from-emerald-500 to-emerald-600",yellow:"from-amber-500 to-orange-500",red:"from-red-500 to-pink-500",purple:"from-purple-500 to-violet-600",cyan:"from-cyan-500 to-blue-500"}[r],{blue:"shadow-blue-500/20",green:"shadow-emerald-500/20",yellow:"shadow-amber-500/20",red:"shadow-red-500/20",purple:"shadow-purple-500/20",cyan:"shadow-cyan-500/20"}[r]),children:(0,f.jsx)("div",{className:"text-white w-6 h-6 [&>svg]:w-6 [&>svg]:h-6 [&>svg]:block",children:t})})]})})},g=({stats:s})=>{const a=s.totalTasks>0?Math.round(s.completedTasks/s.totalTasks*100):0;return(0,f.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,f.jsx)(v,{title:"Toplam GÃ¶revler",value:s.totalTasks,icon:(0,f.jsx)(d,{className:"h-6 w-6"}),color:"blue"}),(0,f.jsx)(v,{title:"Tamamlanan GÃ¶revler",value:s.completedTasks,icon:(0,f.jsx)(t,{className:"h-6 w-6"}),color:"green",trend:{value:a,isPositive:a>=50}}),(0,f.jsx)(v,{title:"Bekleyen Sorunlar",value:s.pendingIssues,icon:(0,f.jsx)(c,{className:"h-6 w-6"}),color:"yellow"}),(0,f.jsx)(v,{title:"Geciken GÃ¶revler",value:s.overdueTasks,icon:(0,f.jsx)(e,{className:"h-6 w-6"}),color:"red"})]})},N=({activities:e,maxItems:s=10})=>{const t=e.slice(0,s),a=e=>{const s="h-9 w-9 rounded-xl flex items-center justify-center text-white text-sm font-semibold shadow-lg";switch(e){case"task_created":return(0,f.jsx)("div",{className:x(s,"bg-gradient-to-br from-blue-500 to-blue-600 shadow-blue-500/30"),children:"+"});case"task_completed":return(0,f.jsx)("div",{className:x(s,"bg-gradient-to-br from-emerald-500 to-emerald-600 shadow-emerald-500/30"),children:"âœ“"});case"issue_reported":return(0,f.jsx)("div",{className:x(s,"bg-gradient-to-br from-amber-500 to-orange-500 shadow-amber-500/30"),children:"!"});case"issue_assigned":return(0,f.jsx)("div",{className:x(s,"bg-gradient-to-br from-purple-500 to-violet-600 shadow-purple-500/30"),children:"â†’"});default:return(0,f.jsx)("div",{className:x(s,"bg-gradient-to-br from-slate-500 to-slate-600"),children:"â€¢"})}},r=e=>{const s=new Date(e),t=new Date,a=Math.floor((t.getTime()-s.getTime())/6e4);if(a<1)return"Az Ã¶nce";if(a<60)return`${a} dakika Ã¶nce`;const r=Math.floor(a/60);if(r<24)return`${r} saat Ã¶nce`;const l=Math.floor(r/24);return l<7?`${l} gÃ¼n Ã¶nce`:s.toLocaleDateString("tr-TR")};return(0,f.jsxs)(j,{title:"Son Aktiviteler",padding:"none",children:[(0,f.jsx)("div",{className:"divide-y divide-white/5",children:0===t.length?(0,f.jsx)("div",{className:"p-6 text-center text-slate-500",children:"HenÃ¼z aktivite bulunmuyor"}):t.map((e,s)=>(0,f.jsx)("div",{className:"p-4 hover:bg-white/[0.02] transition-colors animate-fadeIn",style:{animationDelay:.1*s+"s"},children:(0,f.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,f.jsx)("div",{className:"flex-shrink-0",children:a(e.type)}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"text-sm font-medium text-white",children:e.title}),(0,f.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:e.description}),(0,f.jsxs)("div",{className:"flex items-center mt-2 space-x-2",children:[e.user&&(0,f.jsx)("span",{className:"text-xs text-slate-400",children:e.user.name}),(0,f.jsxs)("span",{className:"text-xs text-slate-500",children:["â€¢ ",r(e.timestamp)]})]})]})]})},e.id))}),e.length>s&&(0,f.jsx)("div",{className:"p-4 border-t border-white/5 text-center",children:(0,f.jsxs)("button",{className:"text-sm font-medium text-blue-400 hover:text-blue-300 transition-colors",children:["TÃ¼mÃ¼nÃ¼ GÃ¶rÃ¼ntÃ¼le (",e.length-s," daha)"]})})]})};const b=()=>{const{data:e,isLoading:s,error:t}=o({queryKey:["task-completion-trend",30],queryFn:()=>(async(e=30)=>{const{data:{session:s}}=await m.auth.getSession();if(!s)throw new Error("No active session");const t=await fetch(`http://localhost:3001/api/analytics/task-completion-trend?days=${e}`,{headers:{Authorization:`Bearer ${s.access_token}`}});if(!t.ok)throw new Error("Failed to fetch task completion trend");return(await t.json()).data})(30),refetchInterval:6e4});if(s)return(0,f.jsx)(j,{title:"GÃ¶rev Tamamlama Trendi (Son 30 GÃ¼n)",padding:"md",children:(0,f.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,f.jsx)(u,{size:"md"})})});if(t)return(0,f.jsx)(j,{title:"GÃ¶rev Tamamlama Trendi (Son 30 GÃ¼n)",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!e||0===e.length)return(0,f.jsx)(j,{title:"GÃ¶rev Tamamlama Trendi (Son 30 GÃ¼n)",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z veri bulunmuyor."})});const a=Math.max(...e.map(e=>Math.max(e.created,e.completed)),1),r=e.filter((e,s)=>s%3==0);return(0,f.jsx)(j,{title:"GÃ¶rev Tamamlama Trendi (Son 30 GÃ¼n)",padding:"md",children:(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-sm",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),(0,f.jsx)("span",{className:"text-slate-300",children:"OluÅŸturulan"})]}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-4 h-4 bg-emerald-500 rounded mr-2"}),(0,f.jsx)("span",{className:"text-slate-300",children:"Tamamlanan"})]})]}),(0,f.jsx)("div",{className:"relative h-64",children:(0,f.jsx)("div",{className:"absolute inset-0 flex items-end justify-between space-x-1",children:e.map(e=>{const s=e.created/a*100,t=e.completed/a*100;return(0,f.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-end space-y-1",children:[(0,f.jsx)("div",{className:"w-full bg-blue-500/80 rounded-t hover:bg-blue-400 transition-colors relative group",style:{height:`${s}%`,minHeight:e.created>0?"4px":"0"},children:(0,f.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none border border-white/10 shadow-lg",children:["OluÅŸturulan: ",e.created]})}),(0,f.jsx)("div",{className:"w-full bg-emerald-500/80 rounded-t hover:bg-emerald-400 transition-colors relative group",style:{height:`${t}%`,minHeight:e.completed>0?"4px":"0"},children:(0,f.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none border border-white/10 shadow-lg",children:["Tamamlanan: ",e.completed]})})]},e.date)})})}),(0,f.jsx)("div",{className:"flex justify-between text-xs text-slate-500",children:r.map(e=>(0,f.jsx)("span",{children:new Date(e.date).toLocaleDateString("tr-TR",{day:"numeric",month:"short"})},e.date))}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-white/10",children:[(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:e.reduce((e,s)=>e+s.created,0)}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam OluÅŸturulan"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-emerald-400",children:e.reduce((e,s)=>e+s.completed,0)}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam Tamamlanan"})]})]})]})})};var y=async()=>{const{data:{session:e}}=await m.auth.getSession();if(!e)throw new Error("No active session");const s=await fetch("http://localhost:3001/api/analytics/user-workload",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)throw new Error("Failed to fetch user workload");return(await s.json()).data};const w=()=>{const{isAdmin:e}=h(),{data:s,isLoading:t,error:a}=o({queryKey:["user-workload"],queryFn:y,enabled:e,refetchInterval:6e4});if(!e)return null;if(t)return(0,f.jsx)(j,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,f.jsx)(u,{size:"md"})})});if(a)return(0,f.jsx)(j,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!s||0===s.length)return(0,f.jsx)(j,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z kullanÄ±cÄ± verisi bulunmuyor."})});const r=[...s].sort((e,s)=>s.totalTasks-e.totalTasks),l=Math.max(...r.map(e=>e.totalTasks),1);return(0,f.jsx)(j,{title:"KullanÄ±cÄ± Ä°ÅŸ YÃ¼kÃ¼ DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsx)("div",{className:"space-y-3",children:r.map(e=>(0,f.jsxs)("div",{className:"space-y-1",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,f.jsx)("span",{className:"font-medium text-white truncate max-w-[200px]",children:e.userName}),(0,f.jsxs)("span",{className:"text-slate-400",children:[e.totalTasks," gÃ¶rev"]})]}),(0,f.jsxs)("div",{className:"relative h-8 bg-slate-700/50 rounded-lg overflow-hidden",children:[(0,f.jsx)("div",{className:"absolute left-0 top-0 h-full bg-emerald-500/80 transition-all",style:{width:e.completedTasks/l*100+"%"}}),(0,f.jsx)("div",{className:"absolute top-0 h-full bg-blue-500/80 transition-all",style:{left:e.completedTasks/l*100+"%",width:e.inProgressTasks/l*100+"%"}}),(0,f.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,f.jsxs)("span",{className:"text-xs font-semibold text-white drop-shadow",children:[e.completionRate,"% tamamlandÄ±"]})})]})]},e.userId))}),(0,f.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-sm pt-4 border-t border-white/10",children:[(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-4 h-4 bg-emerald-500 rounded mr-2"}),(0,f.jsx)("span",{className:"text-slate-300",children:"Tamamlanan"})]}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded mr-2"}),(0,f.jsx)("span",{className:"text-slate-300",children:"Devam Eden"})]}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"w-4 h-4 bg-slate-700/50 rounded mr-2"}),(0,f.jsx)("span",{className:"text-slate-300",children:"DiÄŸer"})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-white/10",children:[(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-white",children:r.length}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"KullanÄ±cÄ±"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:r.reduce((e,s)=>e+s.totalTasks,0)}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam GÃ¶rev"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("p",{className:"text-2xl font-bold text-emerald-400",children:[Math.round(r.reduce((e,s)=>e+s.completionRate,0)/r.length),"%"]}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Ort. Tamamlama"})]})]})]})})};var k=async()=>{const{data:{session:e}}=await m.auth.getSession();if(!e)throw new Error("No active session");const s=await fetch("http://localhost:3001/api/analytics/dashboard",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)throw new Error("Failed to fetch dashboard metrics");return(await s.json()).data};const T=()=>{const{data:e,isLoading:s,error:t}=o({queryKey:["dashboard-metrics"],queryFn:k,refetchInterval:6e4});if(s)return(0,f.jsx)(j,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,f.jsx)(u,{size:"md"})})});if(t)return(0,f.jsx)(j,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-red-400 py-8",children:"Grafik yÃ¼klenirken bir hata oluÅŸtu."})});if(!e||0===e.issues.total)return(0,f.jsx)(j,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsx)("div",{className:"text-center text-slate-400 py-8",children:"HenÃ¼z sorun bulunmuyor."})});const a=[{name:"Kritik",value:e.issues.byPriority.critical,color:"bg-red-500",textColor:"text-red-400"},{name:"YÃ¼ksek",value:e.issues.byPriority.high,color:"bg-orange-500",textColor:"text-orange-400"},{name:"Orta",value:e.issues.byPriority.medium,color:"bg-amber-500",textColor:"text-amber-400"},{name:"DÃ¼ÅŸÃ¼k",value:e.issues.byPriority.low,color:"bg-emerald-500",textColor:"text-emerald-400"}],r=e.issues.total;return(0,f.jsx)(j,{title:"Sorun Ã–ncelik DaÄŸÄ±lÄ±mÄ±",padding:"md",children:(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsx)("div",{className:"flex items-center justify-center",children:(0,f.jsxs)("div",{className:"relative w-48 h-48",children:[(0,f.jsx)("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:a.reduce((e,s)=>{const t=r>0?s.value/r*100:0,a=2*Math.PI*40,l=e.offset,i=`${t/100*a} ${a}`;return e.elements.push((0,f.jsx)("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:s.color.replace("bg-",""),strokeWidth:"20",strokeDasharray:i,strokeDashoffset:-l,className:s.color},s.name)),e.offset+=t/100*a,e},{elements:[],offset:0}).elements}),(0,f.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,f.jsx)("p",{className:"text-3xl font-bold text-white",children:r}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Toplam"})]})]})}),(0,f.jsx)("div",{className:"space-y-2",children:a.map(e=>{const s=r>0?Math.round(e.value/r*100):0;return(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,f.jsx)("div",{className:`w-4 h-4 rounded ${e.color}`}),(0,f.jsx)("span",{className:"text-sm font-medium text-slate-300",children:e.name})]}),(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsxs)("span",{className:"text-sm text-slate-400",children:[e.value," sorun"]}),(0,f.jsxs)("span",{className:`text-sm font-semibold ${e.textColor}`,children:[s,"%"]})]})]},e.name)})}),(0,f.jsx)("div",{className:"pt-4 border-t border-white/10",children:(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-amber-400",children:e.issues.pending}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Bekleyen"})]}),(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-red-400",children:e.issues.byPriority.critical+e.issues.byPriority.high}),(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Acil"})]})]})})]})})};var D=async()=>{const{data:{session:e}}=await m.auth.getSession();if(!e)throw new Error("No active session");const s=await fetch("http://localhost:3001/api/analytics/employees-summary",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)throw new Error("Failed to fetch employees summary");return(await s.json()).data},z=({score:e})=>{return(0,f.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(s=e,s>=90?"bg-green-100 text-green-800":s>=70?"bg-yellow-100 text-yellow-800":s>=50?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"),children:[e," puan"]});var s};const G=()=>{const{data:e,isLoading:s,error:t}=o({queryKey:["employees-summary"],queryFn:D,refetchInterval:6e4});if(s)return(0,f.jsx)(j,{title:"Ã‡alÄ±ÅŸan Ã–zeti",padding:"md",children:(0,f.jsx)("div",{className:"flex justify-center py-8",children:(0,f.jsx)(u,{size:"md"})})});if(t)return(0,f.jsx)(j,{title:"Ã‡alÄ±ÅŸan Ã–zeti",padding:"md",children:(0,f.jsx)("p",{className:"text-red-600 text-sm",children:"Ã‡alÄ±ÅŸan verileri yÃ¼klenemedi."})});const a=[...e||[]].sort((e,s)=>s.activeTasks-e.activeTasks);return(0,f.jsx)(j,{title:"Ã‡alÄ±ÅŸan Ã–zeti",subtitle:`${e?.length||0} Ã§alÄ±ÅŸan`,padding:"md",children:(0,f.jsxs)("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[a.map(e=>(0,f.jsxs)("div",{className:"p-3 rounded-lg border "+(e.overdueTasks>0?"border-red-200 bg-red-50":"border-gray-200 bg-white"),children:[(0,f.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium",children:e.full_name.charAt(0).toUpperCase()}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium text-gray-900",children:e.full_name}),(0,f.jsx)("p",{className:"text-xs text-gray-500",children:e.job_description||e.email})]})]}),(0,f.jsx)(z,{score:e.score||100})]}),(0,f.jsxs)("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[(0,f.jsxs)("div",{className:"bg-blue-50 rounded p-1.5",children:[(0,f.jsx)("p",{className:"font-semibold text-blue-700",children:e.activeTasks}),(0,f.jsx)("p",{className:"text-blue-600",children:"Aktif"})]}),(0,f.jsxs)("div",{className:"bg-green-50 rounded p-1.5",children:[(0,f.jsx)("p",{className:"font-semibold text-green-700",children:e.completedThisWeek}),(0,f.jsx)("p",{className:"text-green-600",children:"Bu Hafta"})]}),(0,f.jsxs)("div",{className:"rounded p-1.5 "+(e.lateTasks>0?"bg-orange-50":"bg-gray-50"),children:[(0,f.jsx)("p",{className:"font-semibold "+(e.lateTasks>0?"text-orange-700":"text-gray-700"),children:e.lateTasks}),(0,f.jsx)("p",{className:e.lateTasks>0?"text-orange-600":"text-gray-600",children:"GeÃ§"})]}),(0,f.jsxs)("div",{className:"rounded p-1.5 "+(e.overdueTasks>0?"bg-red-50":"bg-gray-50"),children:[(0,f.jsx)("p",{className:"font-semibold "+(e.overdueTasks>0?"text-red-700":"text-gray-700"),children:e.overdueTasks}),(0,f.jsx)("p",{className:e.overdueTasks>0?"text-red-600":"text-gray-600",children:"Geciken"})]})]})]},e.id)),(!e||0===e.length)&&(0,f.jsx)("p",{className:"text-gray-500 text-center py-4",children:"HenÃ¼z Ã§alÄ±ÅŸan bulunmuyor."})]})})};var S=async()=>{const{data:{session:e}}=await m.auth.getSession();if(!e)throw new Error("No active session");const s=await fetch("http://localhost:3001/api/analytics/recommendations",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)throw new Error("Failed to fetch recommendations");return(await s.json()).data},$=({severity:e})=>{const s="h-5 w-5";switch(e){case"critical":return(0,f.jsx)(r,{className:`${s} text-red-500`});case"warning":return(0,f.jsx)(c,{className:`${s} text-orange-500`});default:return(0,f.jsx)(l,{className:`${s} text-blue-500`})}},A=e=>{switch(e){case"critical":return"border-red-200 bg-red-50";case"warning":return"border-orange-200 bg-orange-50";default:return"border-blue-200 bg-blue-50"}};const I=()=>{const{data:e,isLoading:s,error:t}=o({queryKey:["ai-recommendations"],queryFn:S,refetchInterval:12e4});return s?(0,f.jsx)(j,{title:"AI Ã–nerileri",padding:"md",children:(0,f.jsx)("div",{className:"flex justify-center py-8",children:(0,f.jsx)(u,{size:"md"})})}):t?(0,f.jsx)(j,{title:"AI Ã–nerileri",padding:"md",children:(0,f.jsx)("p",{className:"text-red-600 text-sm",children:"Ã–neriler yÃ¼klenemedi."})}):(0,f.jsx)(j,{title:"AI Ã–nerileri",subtitle:e?.length?`${e.length} Ã¶neri`:void 0,padding:"md",children:(0,f.jsxs)("div",{className:"space-y-3 max-h-[350px] overflow-y-auto",children:[e?.map((e,s)=>(0,f.jsx)("div",{className:`p-3 rounded-lg border ${A(e.severity)}`,children:(0,f.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,f.jsx)($,{severity:e.severity}),(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.title}),(0,f.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.description}),e.affectedUsers&&e.affectedUsers.length>0&&(0,f.jsxs)("div",{className:"mt-2",children:[(0,f.jsx)("p",{className:"text-xs text-gray-500",children:"Etkilenen kiÅŸiler:"}),(0,f.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.affectedUsers.slice(0,5).map((e,s)=>(0,f.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-white/50 text-gray-700",children:e},s)),e.affectedUsers.length>5&&(0,f.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.affectedUsers.length-5," daha"]})]})]})]})]})},s)),(!e||0===e.length)&&(0,f.jsxs)("div",{className:"text-center py-8",children:[(0,f.jsx)(i,{className:"h-12 w-12 text-green-400 mx-auto mb-3"}),(0,f.jsx)("p",{className:"text-gray-600 font-medium",children:"Her ÅŸey yolunda!"}),(0,f.jsx)("p",{className:"text-gray-500 text-sm",children:"Åžu an iÃ§in Ã¶neri bulunmuyor."})]})]})})};var _=async()=>{const{data:{session:e}}=await m.auth.getSession();if(!e)throw new Error("No active session");const s=await fetch("http://localhost:3001/api/analytics/dashboard",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)throw new Error("Failed to fetch dashboard metrics");return(await s.json()).data};const E=()=>{const{user:e,isAdmin:t}=h(),{data:a,isLoading:r,error:l}=o({queryKey:["dashboard-metrics"],queryFn:_,refetchInterval:6e4,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)}),i={totalTasks:a?.tasks.total||0,completedTasks:a?.tasks.completed||0,pendingIssues:a?.issues.pending||0,overdueTasks:a?.tasks.overdue||0},d=[{id:"1",type:"task_completed",title:"GÃ¶rev TamamlandÄ±",description:"AylÄ±k rapor hazÄ±rlama gÃ¶revi tamamlandÄ±",timestamp:new Date(Date.now()-18e5).toISOString(),user:{name:e?.profile?.full_name||"KullanÄ±cÄ±"}},{id:"2",type:"issue_reported",title:"Yeni Sorun Bildirildi",description:"YazÄ±cÄ± baÄŸlantÄ± sorunu bildirildi",timestamp:new Date(Date.now()-72e5).toISOString(),user:{name:"Ahmet YÄ±lmaz"}},{id:"3",type:"task_created",title:"Yeni GÃ¶rev OluÅŸturuldu",description:"HaftalÄ±k toplantÄ± notlarÄ± hazÄ±rlama",timestamp:new Date(Date.now()-18e6).toISOString(),user:{name:"AyÅŸe Demir"}}];return(0,f.jsx)(p,{children:r?(0,f.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,f.jsx)(u,{size:"lg",message:"YÃ¼kleniyor..."})}):l?(0,f.jsx)("div",{className:"glass-card p-4 border-red-500/20",children:(0,f.jsx)("p",{className:"text-red-400",children:"Metrikler yÃ¼klenirken bir hata oluÅŸtu."})}):(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:["HoÅŸ Geldiniz, ",(0,f.jsx)("span",{className:"gradient-text",children:e?.profile?.full_name||e?.email?.split("@")[0]}),"!"]}),(0,f.jsx)("p",{className:"mt-2 text-slate-400",children:t?"ðŸ“Š YÃ¶netici Paneli":"ðŸ“‹ GÃ¶rev YÃ¶netim Sistemi"})]}),(0,f.jsxs)(n,{to:"/analytics",className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 hover:-translate-y-0.5 transition-all duration-200 [&>svg]:w-5 [&>svg]:h-5",children:[(0,f.jsx)(s,{className:"h-5 w-5"}),"DetaylÄ± Analitik"]})]}),(0,f.jsx)(g,{stats:i}),(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,f.jsx)(b,{}),(0,f.jsx)(T,{})]}),t&&(0,f.jsx)(w,{}),t&&(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,f.jsx)(G,{}),(0,f.jsx)(I,{})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,f.jsx)("div",{className:"lg:col-span-2",children:(0,f.jsx)(N,{activities:d,maxItems:5})}),(0,f.jsx)("div",{children:(0,f.jsx)(j,{title:"HÄ±zlÄ± Bilgiler",padding:"md",children:(0,f.jsxs)("div",{className:"space-y-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Email"}),(0,f.jsx)("p",{className:"text-base font-medium text-white",children:e?.email})]}),e?.profile?.department&&(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Departman"}),(0,f.jsx)("p",{className:"text-base font-medium text-white",children:e.profile.department})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Rol"}),(0,f.jsx)("p",{className:"text-base font-medium text-white",children:t?"YÃ¶netici":"Ã‡alÄ±ÅŸan"})]}),(0,f.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,f.jsx)("p",{className:"text-sm text-slate-400",children:"Hesap Durumu"}),(0,f.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 mt-1",children:"Aktif"})]}),a&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,f.jsx)("p",{className:"text-sm text-slate-400 mb-2",children:"GÃ¶rev Tamamlama OranÄ±"}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("div",{className:"flex-1 bg-slate-700 rounded-full h-2 overflow-hidden",children:(0,f.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:`${a.tasks.completionRate}%`}})}),(0,f.jsxs)("span",{className:"ml-2 text-sm font-medium text-white",children:[a.tasks.completionRate,"%"]})]})]}),(0,f.jsxs)("div",{className:"pt-4 border-t border-white/10",children:[(0,f.jsx)("p",{className:"text-sm text-slate-400 mb-2",children:"GÃ¶rev Durumu"}),(0,f.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-slate-400",children:"Devam Eden:"}),(0,f.jsx)("span",{className:"font-medium text-white",children:a.tasks.inProgress})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-slate-400",children:"Tamamlanan:"}),(0,f.jsx)("span",{className:"font-medium text-emerald-400",children:a.tasks.completed})]}),(0,f.jsxs)("div",{className:"flex justify-between",children:[(0,f.jsx)("span",{className:"text-slate-400",children:"Geciken:"}),(0,f.jsx)("span",{className:"font-medium text-red-400",children:a.tasks.overdue})]})]})]})]})]})})})]})]})})};export{E as Dashboard};