import{n as e}from"./rolldown-runtime-A1xW-pDA.js";import{A as t,F as a,J as s,U as l,_ as r,et as i,f as n,g as d,jt as o,o as c,z as m}from"./react-vendor-2hQaKJT0.js";import"./supabase-vendor-CLitCmdP.js";import{a as x,n as p}from"./index-4_19cBdp.js";import"./NotificationBell-DOonUTZz.js";import{t as u}from"./Layout-Dciw3jEd.js";import{n as h}from"./Modal-BBpZSCNt.js";import"./Input-BaavD_GS.js";import"./Card-9uYyr2OA.js";import"./common-Bvho1dvL.js";var g=e(o(),1),b=i(),f={title:"",description:"",deadline_date:"",reminder_date:"",priority:"medium",category:""};const j=()=>{const e=p(),[i,o]=(0,g.useState)([]),[j,y]=(0,g.useState)(!0),[v,w]=(0,g.useState)(!1),[N,k]=(0,g.useState)(!1),[_,C]=(0,g.useState)(null),[S,D]=(0,g.useState)(f),[$,T]=(0,g.useState)("all"),[z,O]=(0,g.useState)(""),A=(0,g.useRef)(null),B="http://localhost:3001";(0,g.useEffect)(()=>{Y()},[$]);const V=async()=>{const{data:{session:e}}=await x.auth.getSession();return{"Content-Type":"application/json",Authorization:`Bearer ${e?.access_token}`}},Y=async()=>{try{y(!0);const e=await V();let t=`${B}/api/deadlines?`;"upcoming"===$?t+="is_completed=false":"completed"===$&&(t+="is_completed=true");const a=await(await fetch(t,{headers:e})).json();a.data&&o(a.data)}catch(t){e.error("Deadline'lar yüklenirken hata oluştu")}finally{y(!1)}},L=(e,t)=>t?"border-green-500/30 bg-green-500/10":e<0?"border-red-500/50 bg-red-500/10":e<=2?"border-orange-500/50 bg-orange-500/10":e<=5?"border-yellow-500/30 bg-yellow-500/10":"border-blue-500/30 bg-blue-500/10",E={critical:"bg-red-500 text-white",high:"bg-orange-500 text-white",medium:"bg-yellow-500 text-black",low:"bg-blue-500 text-white"},G={critical:"Kritik",high:"Yüksek",medium:"Orta",low:"Düşük"};return(0,b.jsx)(u,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-white flex items-center gap-3",children:[(0,b.jsx)(m,{className:"h-8 w-8 text-purple-400"}),"Deadline'lar"]}),(0,b.jsx)("p",{className:"mt-1 text-slate-400",children:"Görevlerden bağımsız hatırlatma ve takvim sistemi"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(h,{onClick:()=>k(!0),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-300 bg-slate-800 border border-slate-700 rounded-xl hover:bg-slate-700 transition-all",children:[(0,b.jsx)(l,{className:"h-4 w-4"}),"CSV İçe Aktar"]}),(0,b.jsxs)(h,{onClick:async()=>{try{const t=await V(),a=await(await fetch(`${B}/api/deadlines/export`,{headers:t})).json();if(a.data){const t=["deadline_date,reminder_date,title,description,priority,category",...a.data.map(e=>`${e.deadline_date},${e.reminder_date||""},${e.title.replace(/,/g,";")},${(e.description||"").replace(/,/g,";")},${e.priority},${e.category||""}`)].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(s),l.download=`deadlines_${(new Date).toISOString().split("T")[0]}.csv`,l.click(),e.success("CSV dosyası indirildi")}}catch(t){e.error("Dışa aktarma hatası")}},className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-300 bg-slate-800 border border-slate-700 rounded-xl hover:bg-slate-700 transition-all",children:[(0,b.jsx)(s,{className:"h-4 w-4"}),"Dışa Aktar"]}),(0,b.jsxs)(h,{onClick:()=>{C(null),D(f),w(!0)},className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl hover:from-purple-500 hover:to-pink-500 hover:shadow-lg hover:shadow-purple-500/25 transition-all",children:[(0,b.jsx)(d,{className:"h-5 w-5"}),"Yeni Deadline"]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:()=>T("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+("all"===$?"bg-purple-600 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"Tümü"}),(0,b.jsx)("button",{onClick:()=>T("upcoming"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+("upcoming"===$?"bg-purple-600 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"Bekleyenler"}),(0,b.jsx)("button",{onClick:()=>T("completed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all "+("completed"===$?"bg-purple-600 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"),children:"Tamamlananlar"})]}),j?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,b.jsxs)("div",{className:"glass-card p-6 animate-pulse",children:[(0,b.jsx)("div",{className:"h-5 bg-slate-700 rounded w-3/4 mb-3"}),(0,b.jsx)("div",{className:"h-4 bg-slate-700 rounded w-1/2"})]},e))}):0===i.length?(0,b.jsxs)("div",{className:"glass-card p-12 text-center",children:[(0,b.jsx)(m,{className:"h-16 w-16 text-slate-500 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Henüz deadline yok"}),(0,b.jsx)("p",{className:"text-slate-400 mb-6",children:"Yeni bir deadline ekleyerek başlayın veya CSV dosyası yükleyin"}),(0,b.jsxs)(h,{onClick:()=>w(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl",children:[(0,b.jsx)(d,{className:"h-5 w-5"}),"İlk Deadline'ı Ekle"]})]}):(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(s=>{const l=(e=>{const t=new Date;t.setHours(0,0,0,0);const a=new Date(e);return a.setHours(0,0,0,0),Math.ceil((a.getTime()-t.getTime())/864e5)})(s.deadline_date);return(0,b.jsxs)("div",{className:`glass-card p-5 border-l-4 ${L(l,s.is_completed)} transition-all hover:scale-[1.02]`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-3",children:[(0,b.jsx)("h3",{className:"font-semibold "+(s.is_completed?"text-slate-400 line-through":"text-white"),children:s.title}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${E[s.priority]}`,children:G[s.priority]})]}),s.description&&(0,b.jsx)("p",{className:"text-sm text-slate-400 mb-3 line-clamp-2",children:s.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-400 mb-3",children:[(0,b.jsx)(t,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:new Date(s.deadline_date).toLocaleDateString("tr-TR",{day:"numeric",month:"long",year:"numeric"})}),!s.is_completed&&(0,b.jsx)("span",{className:"ml-auto font-medium "+(l<0?"text-red-400":l<=2?"text-orange-400":l<=5?"text-yellow-400":"text-blue-400"),children:l<0?`${Math.abs(l)} gün geçti`:0===l?"Bugün!":1===l?"Yarın":`${l} gün kaldı`})]}),s.category&&(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-slate-700 rounded text-xs text-slate-300 mb-3",children:s.category}),(0,b.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-700",children:[(0,b.jsx)("button",{onClick:()=>(async t=>{try{const a=await V();(await fetch(`${B}/api/deadlines/${t.id}`,{method:"PUT",headers:a,body:JSON.stringify({is_completed:!t.is_completed,completed_at:t.is_completed?null:(new Date).toISOString()})})).ok&&(e.success(t.is_completed?"Görev tekrar açıldı":"Görev tamamlandı"),Y())}catch(a){}})(s),className:"p-2 rounded-lg transition-all "+(s.is_completed?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-slate-700 text-slate-400 hover:bg-slate-600"),title:s.is_completed?"Tekrar aç":"Tamamla",children:(0,b.jsx)(a,{className:"h-5 w-5"})}),(0,b.jsx)("button",{onClick:()=>(e=>{C(e),D({title:e.title,description:e.description||"",deadline_date:e.deadline_date,reminder_date:e.reminder_date||"",priority:e.priority,category:e.category||""}),w(!0)})(s),className:"p-2 rounded-lg bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white transition-all",title:"Düzenle",children:(0,b.jsx)(r,{className:"h-5 w-5"})}),(0,b.jsx)("button",{onClick:()=>(async t=>{if(confirm("Bu deadline'ı silmek istediğinize emin misiniz?"))try{const a=await V();(await fetch(`${B}/api/deadlines/${t}`,{method:"DELETE",headers:a})).ok?(e.success("Deadline silindi"),Y()):e.error("Silinemedi")}catch(a){e.error("Silme hatası")}})(s.id),className:"p-2 rounded-lg bg-slate-700 text-slate-400 hover:bg-red-500/20 hover:text-red-400 transition-all ml-auto",title:"Sil",children:(0,b.jsx)(n,{className:"h-5 w-5"})})]})]},s.id)})}),v&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"glass-card w-full max-w-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:_?"Deadline Düzenle":"Yeni Deadline"}),(0,b.jsx)("button",{onClick:()=>{w(!1),C(null),D(f)},className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700",children:(0,b.jsx)(c,{className:"h-5 w-5"})})]}),(0,b.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),S.title&&S.deadline_date)try{const t=await V(),a=_?`${B}/api/deadlines/${_.id}`:`${B}/api/deadlines`,s=await fetch(a,{method:_?"PUT":"POST",headers:t,body:JSON.stringify(S)}),l=await s.json();s.ok?(e.success(_?"Deadline güncellendi":"Deadline oluşturuldu"),w(!1),C(null),D(f),Y()):e.error(l.message||"Hata oluştu")}catch(a){e.error("Deadline kaydedilemedi")}else e.error("Başlık ve tarih zorunludur")},className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Başlık *"}),(0,b.jsx)("input",{type:"text",value:S.title,onChange:e=>D({...S,title:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Deadline başlığı",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Açıklama"}),(0,b.jsx)("textarea",{value:S.description,onChange:e=>D({...S,description:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",rows:3,placeholder:"Opsiyonel açıklama..."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Son Tarih *"}),(0,b.jsx)("input",{type:"date",value:S.deadline_date,onChange:e=>D({...S,deadline_date:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Hatırlatma Tarihi"}),(0,b.jsx)("input",{type:"date",value:S.reminder_date,onChange:e=>D({...S,reminder_date:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Öncelik"}),(0,b.jsxs)("select",{value:S.priority,onChange:e=>D({...S,priority:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"low",children:"Düşük"}),(0,b.jsx)("option",{value:"medium",children:"Orta"}),(0,b.jsx)("option",{value:"high",children:"Yüksek"}),(0,b.jsx)("option",{value:"critical",children:"Kritik"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Kategori"}),(0,b.jsx)("input",{type:"text",value:S.category,onChange:e=>D({...S,category:e.target.value}),className:"w-full px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ör: Toplantı, Ödeme..."})]})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(h,{type:"button",onClick:()=>{w(!1),C(null),D(f)},className:"flex-1 px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600",children:"İptal"}),(0,b.jsx)(h,{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-500 hover:to-pink-500",children:_?"Güncelle":"Oluştur"})]})]})]})}),N&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,b.jsxs)("div",{className:"glass-card w-full max-w-2xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:"CSV İçe Aktar"}),(0,b.jsx)("button",{onClick:()=>{k(!1),O("")},className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700",children:(0,b.jsx)(c,{className:"h-5 w-5"})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[(0,b.jsx)("p",{className:"text-sm text-slate-300 mb-2",children:"CSV Format:"}),(0,b.jsx)("code",{className:"text-xs text-purple-400",children:"deadline_date,reminder_date,title,description,priority,category"}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Örnek: 2026-02-15,2026-02-10,Vergi Ödemesi,Gelir vergisi son gün,high,Finans"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Dosya Yükle veya Yapıştır"}),(0,b.jsx)("input",{ref:A,type:"file",accept:".csv,.txt",onChange:e=>{const t=e.target.files?.[0];if(t){const e=new FileReader;e.onload=e=>{O(e.target?.result)},e.readAsText(t)}},className:"mb-3 w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-500"}),(0,b.jsx)("textarea",{value:z,onChange:e=>O(e.target.value),className:"w-full h-48 px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white font-mono text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"CSV verilerini buraya yapıştırın..."})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(h,{onClick:()=>{k(!1),O("")},className:"flex-1 px-4 py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-slate-600",children:"İptal"}),(0,b.jsx)(h,{onClick:async()=>{if(z.trim())try{const t=z.trim().split("\n"),a=(t[0].toLowerCase().includes("deadline_date")||t[0].toLowerCase().includes("title")?t.slice(1):t).map(e=>{const[t,a,s,l,r,i]=e.split(",").map(e=>e.trim());return{deadline_date:t,reminder_date:a||null,title:s,description:l||null,priority:r||"medium",category:i||null}}).filter(e=>e.title&&e.deadline_date);if(0===a.length)return void e.error("Geçerli veri bulunamadı");const s=await V(),l=await fetch(`${B}/api/deadlines/import`,{method:"POST",headers:s,body:JSON.stringify({deadlines:a})}),r=await l.json();l.ok?(e.success(`${a.length} deadline içe aktarıldı`),k(!1),O(""),Y()):e.error(r.message||"İçe aktarma hatası")}catch(t){e.error("İçe aktarma hatası")}else e.error("CSV verisi giriniz")},className:"flex-1 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-500 hover:to-pink-500",children:"İçe Aktar"})]})]})]})})]})})};export{j as Deadlines};