import{n as e}from"./rolldown-runtime-A1xW-pDA.js";import{V as t,mt as s,p as a,vt as r}from"./react-vendor-BrW68ebb.js";import"./supabase-vendor-CLitCmdP.js";import{i as l,n as i,t as n}from"./index-BngHtetc.js";import"./NotificationBell-D0CR4O40.js";import{t as o}from"./Layout-DFNvthLu.js";import{n as d}from"./Modal-VQNNPo-d.js";import"./Input-BF1wqZNq.js";import"./Card-CQwe59rg.js";import"./TaskDetail-C2WIGZCr.js";import"./TaskForm-D9lQAQVY.js";var c=e(r(),1),x=t(),m={low:"bg-slate-500/20 text-slate-300",medium:"bg-blue-500/20 text-blue-400",high:"bg-orange-500/20 text-orange-400",critical:"bg-red-500/20 text-red-400"},u={not_started:"bg-slate-500/20 text-slate-300",in_progress:"bg-blue-500/20 text-blue-400",completed:"bg-emerald-500/20 text-emerald-400",blocked:"bg-red-500/20 text-red-400"},h={routine:"Rutin",project:"Proje",one_time:"Tek Seferlik",issue_resolution:"Sorun Çözümü"},p={not_started:"Başlamadı",in_progress:"Devam Ediyor",completed:"Tamamlandı",blocked:"Engellendi"};const j=({task:e,onClick:t})=>{const s=e.due_date&&new Date(e.due_date)<new Date&&"completed"!==e.status;return(0,x.jsxs)("div",{onClick:t,className:i("glass-card p-5 rounded-xl cursor-pointer transition-all duration-300","hover:scale-[1.02] hover:shadow-xl hover:shadow-blue-500/10",s?"border-l-4 border-l-red-500":""),children:[(0,x.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,x.jsx)("h3",{className:"text-lg font-semibold text-white flex-1 pr-2",children:e.title}),(0,x.jsx)("span",{className:i("px-2.5 py-1 text-xs font-medium rounded-full",m[e.priority]),children:e.priority.toUpperCase()})]}),e.description&&(0,x.jsx)("p",{className:"text-sm text-slate-400 mb-4 line-clamp-2",children:e.description}),(0,x.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,x.jsx)("span",{className:i("px-2.5 py-1 text-xs font-medium rounded-full",u[e.status]),children:p[e.status]}),(0,x.jsx)("span",{className:"px-2.5 py-1 text-xs font-medium rounded-full bg-purple-500/20 text-purple-400",children:h[e.category]})]}),e.progress_percentage>0&&(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("div",{className:"flex justify-between text-xs text-slate-400 mb-1",children:[(0,x.jsx)("span",{children:"İlerleme"}),(0,x.jsxs)("span",{className:"text-white font-medium",children:[e.progress_percentage,"%"]})]}),(0,x.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2 overflow-hidden",children:(0,x.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-2 rounded-full transition-all duration-500",style:{width:`${e.progress_percentage}%`}})})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[e.due_date&&(0,x.jsxs)("div",{className:i("flex items-center gap-1",s?"text-red-400 font-medium":""),children:[(0,x.jsx)("svg",{className:"w-4 h-4 [&>path]:stroke-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(e.due_date).toLocaleDateString("tr-TR")]}),e.tags&&e.tags.length>0&&(0,x.jsxs)("div",{className:"flex gap-1",children:[e.tags.slice(0,2).map((e,t)=>(0,x.jsx)("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs",children:e},t)),e.tags.length>2&&(0,x.jsxs)("span",{className:"px-2 py-0.5 bg-slate-700 text-slate-300 rounded text-xs",children:["+",e.tags.length-2]})]})]})]})},g=({filters:e,onFilterChange:t})=>{const s=(s,a)=>{t({...e,[s]:a||void 0})},a="w-full bg-slate-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-colors",r="block text-sm font-medium text-slate-300 mb-1.5";return(0,x.jsxs)("div",{className:"glass-card p-5 rounded-xl mb-6",children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:r,children:"Durum"}),(0,x.jsxs)("select",{value:e.status||"",onChange:e=>s("status",e.target.value),className:a,children:[(0,x.jsx)("option",{value:"",children:"Tümü"}),(0,x.jsx)("option",{value:"not_started",children:"Başlamadı"}),(0,x.jsx)("option",{value:"in_progress",children:"Devam Ediyor"}),(0,x.jsx)("option",{value:"completed",children:"Tamamlandı"}),(0,x.jsx)("option",{value:"blocked",children:"Engellendi"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:r,children:"Kategori"}),(0,x.jsxs)("select",{value:e.category||"",onChange:e=>s("category",e.target.value),className:a,children:[(0,x.jsx)("option",{value:"",children:"Tümü"}),(0,x.jsx)("option",{value:"routine",children:"Rutin"}),(0,x.jsx)("option",{value:"project",children:"Proje"}),(0,x.jsx)("option",{value:"one_time",children:"Tek Seferlik"}),(0,x.jsx)("option",{value:"issue_resolution",children:"Sorun Çözümü"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:r,children:"Öncelik"}),(0,x.jsxs)("select",{value:e.priority||"",onChange:e=>s("priority",e.target.value),className:a,children:[(0,x.jsx)("option",{value:"",children:"Tümü"}),(0,x.jsx)("option",{value:"low",children:"Düşük"}),(0,x.jsx)("option",{value:"medium",children:"Orta"}),(0,x.jsx)("option",{value:"high",children:"Yüksek"}),(0,x.jsx)("option",{value:"critical",children:"Kritik"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:r,children:"Sırala"}),(0,x.jsxs)("select",{value:e.sort_by||"created_at",onChange:e=>s("sort_by",e.target.value),className:a,children:[(0,x.jsx)("option",{value:"created_at",children:"Oluşturma Tarihi"}),(0,x.jsx)("option",{value:"updated_at",children:"Güncelleme Tarihi"}),(0,x.jsx)("option",{value:"due_date",children:"Bitiş Tarihi"}),(0,x.jsx)("option",{value:"priority",children:"Öncelik"}),(0,x.jsx)("option",{value:"status",children:"Durum"}),(0,x.jsx)("option",{value:"title",children:"Başlık"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{className:r,children:"Sıralama"}),(0,x.jsxs)("select",{value:e.sort_order||"desc",onChange:e=>s("sort_order",e.target.value),className:a,children:[(0,x.jsx)("option",{value:"desc",children:"Azalan"}),(0,x.jsx)("option",{value:"asc",children:"Artan"})]})]})]}),(0,x.jsx)("div",{className:"mt-4 flex justify-end",children:(0,x.jsx)("button",{onClick:()=>t({}),className:"text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Filtreleri Temizle"})})]})},v=()=>{const[e,t]=(0,c.useState)([]),[a,r]=(0,c.useState)(!0),[i,o]=(0,c.useState)(null),[d,m]=(0,c.useState)({sort_by:"created_at",sort_order:"desc"}),u=s();(0,c.useEffect)(()=>{h()},[d]),(0,c.useEffect)(()=>{let e;return(async()=>{const{data:{session:s}}=await l.auth.getSession();s&&(e=l.channel("tasks-realtime").on("postgres_changes",{event:"*",schema:"public",table:"tasks"},e=>{"INSERT"===e.eventType?t(t=>[e.new,...t]):"UPDATE"===e.eventType?t(t=>t.map(t=>t.id===e.new.id?e.new:t)):"DELETE"===e.eventType&&t(t=>t.filter(t=>t.id!==e.old.id))}).subscribe())})(),()=>{e&&l.removeChannel(e)}},[]);const h=async()=>{try{r(!0),o(null);const{data:{session:e}}=await l.auth.getSession();if(!e)return void o("Oturum bulunamadı");const s=new URLSearchParams;d.status&&s.append("status",d.status),d.category&&s.append("category",d.category),d.priority&&s.append("priority",d.priority),d.sort_by&&s.append("sort_by",d.sort_by),d.sort_order&&s.append("sort_order",d.sort_order);const a=await fetch(`http://localhost:3001/api/tasks?${s.toString()}`,{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Görevler yüklenemedi");t((await a.json()).data||[])}catch(e){o(e instanceof Error?e.message:"Bir hata oluştu")}finally{r(!1)}};return a?(0,x.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,x.jsx)(n,{size:"lg",message:"Görevler yükleniyor..."})}):i?(0,x.jsxs)("div",{className:"glass-card p-6 rounded-xl border-red-500/30",children:[(0,x.jsx)("p",{className:"font-medium text-red-400",children:"Hata"}),(0,x.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:i}),(0,x.jsx)("button",{onClick:h,className:"mt-3 text-sm text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Tekrar Dene"})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)(g,{filters:d,onFilterChange:m}),0===e.length?(0,x.jsxs)("div",{className:"glass-card p-10 rounded-xl text-center",children:[(0,x.jsx)("svg",{className:"mx-auto h-12 w-12 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,x.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,x.jsx)("h3",{className:"mt-3 text-base font-medium text-white",children:"Görev bulunamadı"}),(0,x.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Seçili filtrelere uygun görev bulunmuyor."})]}):(0,x.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,x.jsx)(j,{task:e,onClick:()=>{return t=e.id,void u(`/tasks/${t}`);var t}},e.id))})]})},b=()=>{const e=s();return(0,x.jsx)(o,{children:(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Görevler"}),(0,x.jsx)("p",{className:"mt-1 text-slate-400",children:"Görevlerinizi görüntüleyin ve yönetin"})]}),(0,x.jsxs)(d,{onClick:()=>e("/tasks/new"),className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl hover:from-blue-500 hover:to-purple-500 hover:shadow-lg hover:shadow-blue-500/25 hover:-translate-y-0.5 transition-all duration-200 [&>svg]:w-5 [&>svg]:h-5",children:[(0,x.jsx)(a,{className:"h-5 w-5"}),"Yeni Görev"]})]}),(0,x.jsx)(v,{})]})})};export{b as Tasks};