import{n as s}from"./rolldown-runtime-A1xW-pDA.js";import{J as e,Tt as t,h as i,xt as o}from"./react-vendor-DnbmBACz.js";import"./supabase-vendor-CLitCmdP.js";import{i as a}from"./index-CDPVztAZ.js";import"./NotificationBell-DpekPiHl.js";import{t as r}from"./Layout-3NCdNaPA.js";import{n,t as l}from"./Modal-Dnx87MuO.js";import"./Input-CFqmQddI.js";import{n as c,r as d}from"./issues-BFhsayCm.js";var h=s(t(),1),m=e();const u=()=>{const s=o(),[e,t]=(0,h.useState)([]),[u,p]=(0,h.useState)(!0),[f,x]=(0,h.useState)(!1);(0,h.useEffect)(()=>{j();const s=a.channel("issues-changes").on("postgres_changes",{event:"*",schema:"public",table:"issues"},()=>{j()}).subscribe();return()=>{a.removeChannel(s)}},[]);const j=async()=>{try{p(!0);const{data:{session:e}}=await a.auth.getSession();if(!e)return void s("/login");const i=await fetch("http://localhost:3001/api/issues",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!i.ok)throw new Error("Failed to fetch issues");t((await i.json()).data||[])}catch(e){}finally{p(!1)}};return(0,m.jsx)(r,{children:(0,m.jsxs)("div",{className:"space-y-6",children:[(0,m.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Sorun Bildirimleri"}),(0,m.jsx)("p",{className:"mt-1 text-slate-400",children:"Karşılaştığınız sorunları bildirin ve çözüm sürecini takip edin"})]}),(0,m.jsxs)(n,{variant:"primary",onClick:()=>x(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-red-600 to-orange-600 rounded-xl hover:from-red-500 hover:to-orange-500 hover:shadow-lg hover:shadow-red-500/25 hover:-translate-y-0.5 transition-all duration-200 [&>svg]:w-5 [&>svg]:h-5",children:[(0,m.jsx)(i,{className:"h-5 w-5"}),"Yeni Sorun Bildir"]})]}),(0,m.jsx)(c,{issues:e,loading:u,onIssueClick:s=>{},emptyMessage:"Henüz sorun bildirimi yok. İlk sorunu siz bildirin!"}),(0,m.jsx)(l,{isOpen:f,onClose:()=>x(!1),title:"Yeni Sorun Bildir",children:(0,m.jsx)(d,{onSubmit:async e=>{try{const{data:{session:t}}=await a.auth.getSession();if(!t)return void s("/login");const i=await fetch("http://localhost:3001/api/issues",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.access_token}`},body:JSON.stringify(e)});if(!i.ok){const s=await i.json();throw new Error(s.message||"Failed to create issue")}x(!1),j()}catch(t){throw t}},onCancel:()=>x(!1)})})]})})};export{u as Issues};